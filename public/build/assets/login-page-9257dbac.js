import{_ as y,d as P,o as R,m as E,r as b,a as h,c as $,b as o,w as a,l as N,e as n,f as F,g as q,h as B,i as t,j as k,u as C,k as I}from"./app-44c844f3.js";const z=P({components:{Open:R},setup(){const e=E(),l=C(),d=b(!1),v=b(),u=h({userName:"",password:""}),c=h({userName:"",password:""}),m=h({userName:[{required:!0,message:"Email Must be Required",trigger:"change"}],password:[{required:!0,message:"Password Must be Required",trigger:"change"}]});return{ruleForm:c,rules:m,errors:u,ruleFormRef:v,busy:d,login:async f=>{await f.validate(async(g,w)=>{if(g)try{const s="/login";d.value=!0;const{data:r}=await axios.post(s,{email:c.userName,password:c.password});e.addToken(r.token),e.addUser(r.user),console.log(r),l.push({name:"home"})}catch(s){console.error(s);const r=s==null?void 0:s.response;if(r&&r.status==422){const i=r.data.errors;N.hasIn(i,"loginEmail")&&(u.userName=i.loginEmail[0]),N.hasIn(i,"loginPassword")&&(u.password=i.loginPassword[0])}}else console.log("error submit!",w);d.value=!1})}}}}),D={class:"login-page"},U=t("div",{class:"card-header"},[t("span",null,"Login")],-1),L={class:"login-btn-box"},M=t("span",{class:"ml-2"},"Login",-1),T={class:"redirect-info"},j=t("b",null,"Register",-1),O={class:"redirect-info"},S=t("b",null,"Password",-1);function A(e,l,d,v,u,c){const m=n("el-input"),_=n("el-form-item"),f=n("open"),g=n("el-icon"),w=n("el-button"),s=n("el-link"),r=n("el-form"),i=n("el-card"),V=I("loading");return F(),$("div",D,[o(i,null,{header:a(()=>[U]),default:a(()=>[q((F(),B(r,{ref:"ruleFormRef",model:e.ruleForm,rules:e.rules,"label-position":"top"},{default:a(()=>[o(_,{label:"Email",prop:"userName",error:e.errors.userName},{default:a(()=>[o(m,{size:"large",placeholder:"Please Input",modelValue:e.ruleForm.userName,"onUpdate:modelValue":l[0]||(l[0]=p=>e.ruleForm.userName=p)},null,8,["modelValue"])]),_:1},8,["error"]),o(_,{label:"Password",prop:"password",error:e.errors.password},{default:a(()=>[o(m,{"show-password":"",size:"large",placeholder:"Please Input",modelValue:e.ruleForm.password,"onUpdate:modelValue":l[1]||(l[1]=p=>e.ruleForm.password=p)},null,8,["modelValue"])]),_:1},8,["error"]),t("div",L,[o(w,{size:"large",type:"primary",onClick:l[2]||(l[2]=p=>e.login(e.ruleFormRef))},{default:a(()=>[o(g,null,{default:a(()=>[o(f)]),_:1}),M]),_:1})]),t("div",T,[k(" Don't have an account yet? "),o(s,{href:"/register"},{default:a(()=>[j]),_:1})]),t("div",O,[k(" Forgot "),o(s,{href:"/forgot-password"},{default:a(()=>[S]),_:1})])]),_:1},8,["model","rules"])),[[V,e.busy]])]),_:1})])}const H=y(z,[["render",A]]);export{H as default};
