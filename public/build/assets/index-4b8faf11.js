import{A as R,P as O}from"./PageTitleBox-ebdb7c37.js";import{P as z}from"./Pagination-d3273910.js";import{R as N}from"./RemoveEditButton-5e934d45.js";import{F as q,r as D,u as Q}from"./index-d538a892.js";import{h as F}from"./moment-fbc5633a.js";import{_ as S,r as a,B as H,o as p,h as C,i as b,k as n,a as s,c as P,l as E,F as B,s as M,j as i,e as A,t as L,u as I,D as G,E as J}from"./app-ec84c5d3.js";import{C as K}from"./CreateButton-d297d6f1.js";import{S as W}from"./statusBtn-1497cb5d.js";const X={components:{FormDialog:q},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},teams:{type:Array,required:!0}},setup(w,{emit:t}){let U=a(!1);const e=a(null);let T=a(""),k=a(null),v=a(null),m=a([]),y=a(null),g=a(null);const x=a(F().format(dateFormat)),h=a(null),V=a(""),f=a([]);let o=a(!1);return H(m,_=>{_.map(r=>r.value).includes(y)||(y.value=null)}),{props:w,form:e,emit:t,save:async()=>{let _=route("project.store");if(!await e.value.validate())return console.error("validation errors"),null;U.value=!0;const d={title:T.value,manager:k.value,category:v.value,members:m.value.map(c=>c.id),team:g.value,team_manager:y.value,byTeam:o.value?1:0,start:x.value,end:h.value,attachments:f.value,description:V.value},l=new FormData;l.append("title",d.title),l.append("manager",d.manager),l.append("category",d.category),d.team&&l.append("team",d.team),l.append("team_manager",d.team_manager),l.append("byTeam",d.byTeam),l.append("start",d.start),l.append("end",d.end),l.append("description",d.description),d.members.forEach((c,j)=>{l.append(`members[${j}]`,c)}),d.attachments.forEach((c,j)=>{l.append(`attachments[${j}]`,c)});try{const{data:c}=await axios.post(_,l);t("push",addProtos(c,{action:!0,showEdit:!1}))}catch(c){console.error(c),validErorrs(c)}U.value=!1},rs:D,busy:U,byTeam:o,team_manager:y,team:g,title:T,start:x,end:h,manager:k,category:v,members:m,description:V,attachments:f}}},Y={class:"layout gutter--md"},Z={class:"row align-content--center"},$={class:"flex xs12 in-box"},ee={class:"flex xs12 in-box"},te={class:"flex xs12 in-box"},oe={class:"flex xs12"},le=s("h1",null,"Project Assignment By:-",-1),ae={key:0,class:"flex xs12 in-box"},ne={key:1,class:"flex xs12 in-box"},re={key:2,class:"flex xs12 mb-2"},se=s("h1",null,"Project Leader:-",-1),ie={class:"flex xs6 in-box"},de={class:"flex xs6 in-box"},me={class:"flex xs12 in-box"},ue={class:"flex xs12",style:{"min-height":"150px","margin-bottom":"50px"}};function ce(w,t,U,e,T,k){const v=i("va-input"),m=i("va-select"),y=i("va-radio"),g=i("va-chip"),x=i("va-file-upload"),h=i("QuillEditor"),V=i("va-form"),f=i("form-dialog");return p(),C(f,{show:e.props.show,"onUpdate:show":t[11]||(t[11]=o=>e.emit("update:show",o)),busy:e.busy,title:"Create Project",onAdd:e.save,fullscreen:!0},{default:b(()=>[n(V,{ref:"form"},{default:b(()=>[s("div",Y,[s("div",Z,[s("div",$,[n(v,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=o=>e.title=o),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),s("div",ee,[n(m,{modelValue:e.manager,"onUpdate:modelValue":t[1]||(t[1]=o=>e.manager=o),label:"Project Manager *",placeholder:"Project Manager Here",rules:e.rs("manager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),s("div",te,[n(m,{modelValue:e.category,"onUpdate:modelValue":t[2]||(t[2]=o=>e.category=o),label:"Project Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),s("div",oe,[le,(p(),P(B,null,E([{text:"ByTeam",value:!0},{text:"By Members",value:!1}],(o,u)=>n(y,{key:u,modelValue:e.byTeam,"onUpdate:modelValue":t[3]||(t[3]=_=>e.byTeam=_),label:o.text,option:o.value},null,8,["modelValue","label","option"])),64))]),e.byTeam?(p(),P("div",ae,[n(m,{modelValue:e.team,"onUpdate:modelValue":t[4]||(t[4]=o=>e.team=o),label:"Project Team*",placeholder:"Project Team Here","text-by":"title","value-by":"id",options:e.props.teams},null,8,["modelValue","options"])])):(p(),P("div",ne,[n(m,{modelValue:e.members,"onUpdate:modelValue":t[5]||(t[5]=o=>e.members=o),label:"Project Employees *",placeholder:"Project Employee Here",rules:e.rs("members",!e.byTeam),multiple:"",searchable:"","text-by":"name",options:e.props.employees.filter(o=>o.id!=e.manager)},{content:b(({value:o})=>[(p(!0),P(B,null,E(o,u=>(p(),C(g,{key:u,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":_=>w.deleteChip(u)},{default:b(()=>[A(L(u.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])),!e.byTeam&&e.members.length>1?(p(),P("div",re,[se,(p(!0),P(B,null,E(e.members,(o,u)=>(p(),C(y,{key:u,modelValue:e.team_manager,"onUpdate:modelValue":t[6]||(t[6]=_=>e.team_manager=_),label:o.name,option:o.id},null,8,["modelValue","label","option"]))),128))])):M("",!0),s("div",ie,[n(v,{modelValue:e.start,"onUpdate:modelValue":t[7]||(t[7]=o=>e.start=o),label:"Start *",type:"date",placeholder:"Start Here",rules:e.rs("start",!0)},null,8,["modelValue","rules"])]),s("div",de,[n(v,{modelValue:e.end,"onUpdate:modelValue":t[8]||(t[8]=o=>e.end=o),type:"date",label:"Dead Line *",placeholder:"Dead Line Here",rules:e.rs("dead line",!0)},null,8,["modelValue","rules"])]),s("div",me,[n(x,{modelValue:e.attachments,"onUpdate:modelValue":t[9]||(t[9]=o=>e.attachments=o),dropzone:""},null,8,["modelValue"])]),s("div",ue,[n(h,{theme:"snow",toolbar:"minimal",contentType:"html",content:e.description,"onUpdate:content":t[10]||(t[10]=o=>e.description=o),placeholder:"Description Html Contant"},null,8,["content"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const pe=S(X,[["render",ce]]),ve={components:{FormDialog:q},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},teams:{type:Array,required:!0},item:{type:Object,required:!0}},setup(w,{emit:t}){let U=a(w.item),e=a(!1);const T=a(null);let k=a(""),v=a(null),m=a(null),y=a([]),g=a(null),x=a(null);const h=a(F().format(dateFormat)),V=a(null),f=a(""),o=a([]);let u=a(!0);return H(y,r=>{r.map(d=>d.value).includes(g)||(g.value=null)}),H(w.item,r=>{k.value=r.title,v.value=r.manager_id,m.value=r.category_id,x.value=r.team_id,h.value=r.start,V.value=r.end,f.value=r.description,U.value=r},{immediate:!0}),{props:w,form:T,emit:t,save:async()=>{let r=route("project.update",{project:U.value.id});if(!await T.value.validate())return null;try{const{data:l}=await axios.put(r,{title:k.value,manager:v.value,category:m.value,members:y.value.map(c=>c.id),team:x.value,team_manager:g.value,byTeam:u.value?1:0,start:h.value,end:V.value,attachments:o.value,description:f.value});t("replace",addProtos(l,{action:!0,showEdit:!1}))}catch(l){console.error(l),validErorrs(l)}},rs:D,busy:e,byTeam:u,team_manager:g,team:x,title:k,start:h,end:V,manager:v,category:m,members:y,description:f,attachments:o}}},ye={class:"layout gutter--md"},_e={class:"row align-content--center"},be={class:"flex xs12 in-box"},ge={class:"flex xs12 in-box"},fe={class:"flex xs12 in-box"},xe={class:"flex xs12"},he=s("h1",null,"Project Assignment By:-",-1),Ve={key:0,class:"flex xs12 in-box"},we={key:1,class:"flex xs12 in-box"},Pe={key:2,class:"flex xs12 mb-2"},ke=s("h1",null,"Project Leader:-",-1),Ue={class:"flex xs6 in-box"},Te={class:"flex xs6 in-box"},je={class:"flex xs12 in-box"},Ce={class:"flex xs12",style:{"min-height":"150px","margin-bottom":"50px"}};function Ee(w,t,U,e,T,k){const v=i("va-input"),m=i("va-select"),y=i("va-radio"),g=i("va-chip"),x=i("va-file-upload"),h=i("QuillEditor"),V=i("va-form"),f=i("form-dialog");return p(),C(f,{show:e.props.show,"onUpdate:show":t[11]||(t[11]=o=>e.emit("update:show",o)),busy:e.busy,title:"Edit Project",onAdd:e.save,"is-edit":"",fullscreen:!0},{default:b(()=>[n(V,{ref:"form"},{default:b(()=>[s("div",ye,[s("div",_e,[s("div",be,[n(v,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=o=>e.title=o),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),s("div",ge,[n(m,{modelValue:e.manager,"onUpdate:modelValue":t[1]||(t[1]=o=>e.manager=o),label:"Project Manager *",placeholder:"Project Manager Here",rules:e.rs("manager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),s("div",fe,[n(m,{modelValue:e.category,"onUpdate:modelValue":t[2]||(t[2]=o=>e.category=o),label:"Project Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),s("div",xe,[he,(p(),P(B,null,E([{text:"ByTeam",value:!0},{text:"By Members",value:!1}],(o,u)=>n(y,{key:u,modelValue:e.byTeam,"onUpdate:modelValue":t[3]||(t[3]=_=>e.byTeam=_),label:o.text,option:o.value},null,8,["modelValue","label","option"])),64))]),e.byTeam?(p(),P("div",Ve,[n(m,{modelValue:e.team,"onUpdate:modelValue":t[4]||(t[4]=o=>e.team=o),label:"Project Team*",placeholder:"Project Team Here",rules:e.rs("team",e.byTeam),"text-by":"title","value-by":"id",options:e.props.teams},null,8,["modelValue","rules","options"])])):(p(),P("div",we,[n(m,{modelValue:e.members,"onUpdate:modelValue":t[5]||(t[5]=o=>e.members=o),label:"Project Employees *",placeholder:"Project Employee Here",rules:e.rs("members",!e.byTeam),multiple:"",searchable:"","text-by":"name",options:e.props.employees.filter(o=>o.id!=e.manager)},{content:b(({value:o})=>[(p(!0),P(B,null,E(o,u=>(p(),C(g,{key:u,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":_=>w.deleteChip(u)},{default:b(()=>[A(L(u.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])),!e.byTeam&&e.members.length>1?(p(),P("div",Pe,[ke,(p(!0),P(B,null,E(e.members,(o,u)=>(p(),C(y,{key:u,modelValue:e.team_manager,"onUpdate:modelValue":t[6]||(t[6]=_=>e.team_manager=_),label:o.name,option:o.id},null,8,["modelValue","label","option"]))),128))])):M("",!0),s("div",Ue,[n(v,{modelValue:e.start,"onUpdate:modelValue":t[7]||(t[7]=o=>e.start=o),label:"Start *",type:"date",placeholder:"Start Here",rules:e.rs("start",!0)},null,8,["modelValue","rules"])]),s("div",Te,[n(v,{modelValue:e.end,"onUpdate:modelValue":t[8]||(t[8]=o=>e.end=o),type:"date",label:"Dead Line *",placeholder:"Dead Line Here",rules:e.rs("dead line",!0)},null,8,["modelValue","rules"])]),s("div",je,[n(x,{modelValue:e.attachments,"onUpdate:modelValue":t[9]||(t[9]=o=>e.attachments=o),dropzone:""},null,8,["modelValue"])]),s("div",Ce,[n(h,{theme:"snow",toolbar:"minimal",contentType:"html",content:e.description,"onUpdate:content":t[10]||(t[10]=o=>e.description=o),placeholder:"Description Html Contant"},null,8,["content"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const Be=S(ve,[["render",Ee]]);const Ae={components:{AppLayout:R,PageTitleBox:O,Pagination:z,Create:pe,Edit:Be,CreateButton:K,RemoveEditButton:N,StatusBtn:W},setup(){const w=a(!0),t=Q(),U=I(),e=a([]),T=a([]),k=a([]),v=a([]),m=a(!1),y=a([]),g=a(10),x=a("title"),h=[{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"title",sortable:!0},{key:"manager.name",label:"Manager",sortable:!0},{key:"category.title",label:"Category",sortable:!0},{key:"start",label:"Start",sortable:!0},{key:"end",label:"Dead Line",sortable:!0},{key:"team.title",label:"Team",sortable:!0},{key:"status",sortable:!0},{key:"action",thAlign:"right",tdAlign:"right"}],V=a("asc");axios.get(route("employee.index",{all:!0})).then(({data:r})=>T.value=r),axios.get(route("category.index",{all:!0})).then(({data:r})=>k.value=r),axios.get(route("team.index",{all:!0})).then(({data:r})=>v.value=r);const f=async r=>{try{const d=route("project.index",{perPage:g.value,page:r}),{data:l}=await axios.get(d);y.value=l.links,e.value=addProtos(l.data,{action:!0,showEdit:!1})}catch(d){console.error(d)}w.value=!1};return f(1),{router:U,showCreate:m,perPage:g,sortingOrder:V,items:e,columns:h,sortBy:x,push:r=>{m.value=!1,e.value.push(r)},replace:(r,d)=>{m.value=!1,e.value.splice(d,1,r)},fetchItems:f,employees:T,categories:k,teams:v,remove:async(r,d)=>{if(!await G(r,"Project","title"))return null;try{const c=route("project.destroy",{project:r.id});await axios.delete(c),e.value.splice(d,1),J(t)}catch(c){console.log(c)}},links:y,busy:w}}},He={class:"row mt-4"},Se={class:"flex md6"},Le={class:"item"},qe={class:"flex lg6"},De={class:"item right"};function Fe(w,t,U,e,T,k){const v=i("create-button"),m=i("page-title-box"),y=i("va-select"),g=i("va-icon"),x=i("va-input"),h=i("va-chip"),V=i("status-btn"),f=i("edit"),o=i("remove-edit-button"),u=i("va-data-table"),_=i("pagination"),r=i("create"),d=i("app-layout");return p(),C(d,{busy:e.busy},{default:b(()=>[s("div",null,[n(m,{title:"Projects"},{default:b(()=>[n(v,{title:"Add Project",onClick:t[0]||(t[0]=l=>e.showCreate=!0)})]),_:1})]),s("div",He,[s("div",Se,[s("div",Le,[n(y,{class:"flex mb-2 md6",label:"Per Page",modelValue:e.perPage,"onUpdate:modelValue":t[1]||(t[1]=l=>e.perPage=l),options:[10,20,30,40,50]},null,8,["modelValue"])])]),s("div",qe,[s("div",De,[n(x,{class:"flex mb-2 md6",label:"Search"},{prepend:b(()=>[n(g,{class:"material-icons"},{default:b(()=>[A("search")]),_:1})]),_:1})])])]),n(u,{items:e.items,columns:e.columns,hoverable:!0,"sort-by":e.sortBy,"onUpdate:sortBy":t[2]||(t[2]=l=>e.sortBy=l),"sorting-order":e.sortingOrder,"onUpdate:sortingOrder":t[3]||(t[3]=l=>e.sortingOrder=l)},{"cell(members)":b(({rowData:l})=>[(p(!0),P(B,null,E(l.members,c=>(p(),C(h,{size:"small",key:c.id},{default:b(()=>[A(L(c.name),1)]),_:2},1024))),128))]),"cell(status)":b(({value:l})=>[n(V,{status:l},null,8,["status"])]),"cell(action)":b(({rowData:l,rowIndex:c})=>[n(o,{isView:!0,onViewClick:j=>e.router.push({name:"project.show",params:{id:l.id}}),onEditClick:j=>l.showEdit=!0,onRemoveClick:j=>e.remove(l,c)},{default:b(()=>[n(f,{show:l.showEdit,"onUpdate:show":j=>l.showEdit=j,item:l,employees:e.employees,categories:e.categories,teams:e.teams,onReplace:j=>e.replace(j,c)},null,8,["show","onUpdate:show","item","employees","categories","teams","onReplace"])]),_:2},1032,["onViewClick","onEditClick","onRemoveClick"])]),_:1},8,["items","columns","sort-by","sorting-order"]),n(_,{links:e.links,onPage:e.fetchItems},null,8,["links","onPage"]),n(r,{show:e.showCreate,"onUpdate:show":t[4]||(t[4]=l=>e.showCreate=l),employees:e.employees,categories:e.categories,teams:e.teams,onPush:e.push},null,8,["show","employees","categories","teams","onPush"])]),_:1},8,["busy"])}const Je=S(Ae,[["render",Fe],["__scopeId","data-v-6231a4ab"]]);export{Je as default};
