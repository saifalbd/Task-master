import{A as F,_ as z}from"./PageTitleBox-9be017fa.js";import{P as N}from"./Pagination-53b45834.js";import{R as S}from"./RemoveEditButton-08b4a9fb.js";import{F as R,r as q,u as j}from"./index-6f6f3ed4.js";import{_ as E,r as s,C as P,o as h,g as w,h as _,j as i,a as d,c as A,k as B,F as M,i as l,b as U,t as H,E as I,G as L}from"./app-fb8c1635.js";import{C as G}from"./CreateButton-a3f51907.js";const J={components:{FormDialog:R},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0}},setup(g,{emit:o}){let m=s(!1);const e=s(null);let f=s(""),p=s(null),c=s(null),a=s([]);return P(p,y=>{a.value=a.value.filter(t=>t!=y)}),{props:g,form:e,emit:o,save:async()=>{if(!await e.value.validate())return null;try{const{data:t}=await axios.post(route("team.store"),{title:f.value,manager_id:p.value,category_id:c.value,members:a.value});o("push",addProtos(t,{action:!0,showEdit:!1}))}catch(t){console.error(t),validErorrs(t)}},deleteChip:y=>{a.value=a.value.filter(t=>t!==y.id)},busy:m,rs:q,title:f,manager:p,category:c,members:a}}},K={class:"layout gutter--lg"},Q={class:"row align-content--center"},W={class:"flex xs12"},X={class:"flex xs12 mt-2"},Y={class:"flex xs12 mt-2"},Z={class:"flex xs12 mt-2"};function D(g,o,m,e,f,p){const c=l("va-input"),a=l("va-select"),u=l("va-chip"),b=l("va-form"),y=l("form-dialog");return h(),w(y,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Create Team",onAdd:e.save,fullscreen:""},{default:_(()=>[i(b,{ref:"form"},{default:_(()=>[d("div",K,[d("div",Q,[d("div",W,[i(c,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.title=t),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),d("div",X,[i(a,{modelValue:e.manager,"onUpdate:modelValue":o[1]||(o[1]=t=>e.manager=t),label:"Team Manager *",placeholder:"Team Manager Here",rules:e.rs("teamManager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),d("div",Y,[i(a,{modelValue:e.category,"onUpdate:modelValue":o[2]||(o[2]=t=>e.category=t),label:"Team Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),d("div",Z,[i(a,{modelValue:e.members,"onUpdate:modelValue":o[3]||(o[3]=t=>e.members=t),label:"Team Members *",placeholder:"Team Members Here",rules:e.rs("members",!0),multiple:"",searchable:"","text-by":"name","value-by":"id",options:e.props.employees.filter(t=>t.id!=e.manager)},{content:_(({value:t})=>[(h(!0),A(M,null,B(t,r=>(h(),w(u,{key:r,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":T=>e.deleteChip(r)},{default:_(()=>[U(H(r.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const $=E(J,[["render",D]]),ee={components:{FormDialog:R},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},item:{type:Object,required:!0}},setup(g,{emit:o}){let m=s(g.item),e=s(!1);const f=s(null);let p=s(m.value.title),c=s(m.value.manager_id),a=s(m.value.category_id),u=s(m.value.members.map(t=>t.id));return P(c,t=>{u.value=u.value.filter(r=>r!=t)}),P(g.item,t=>{m.value=t,u.value=t.members.map(r=>r.id),p.value=t.title,c.value=t.manager_id,a.value=t.category_id}),{props:g,form:f,emit:o,save:async()=>{if(!await f.value.validate())return null;try{const{data:r}=await axios.put(route("team.update",{team:m.value.id}),{title:p.value,manager_id:c.value,category_id:a.value,members:u.value});o("replace",addProtos(r,{action:!0,showEdit:!1}))}catch(r){console.error(r),validErorrs(r)}},deleteChip:t=>{u.value=u.value.filter(r=>r!==t.id)},busy:e,rs:q,title:p,manager:c,category:a,members:u}}},te={class:"layout gutter--lg"},oe={class:"row align-content--center"},ae={class:"flex xs12"},le={class:"flex xs12 mt-2"},se={class:"flex xs12 mt-2"},re={class:"flex xs12 mt-2"};function ne(g,o,m,e,f,p){const c=l("va-input"),a=l("va-select"),u=l("va-chip"),b=l("va-form"),y=l("form-dialog");return h(),w(y,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Edit Team",onAdd:e.save,"is-edit":"",fullscreen:""},{default:_(()=>[i(b,{ref:"form"},{default:_(()=>[d("div",te,[d("div",oe,[d("div",ae,[i(c,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.title=t),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),d("div",le,[i(a,{modelValue:e.manager,"onUpdate:modelValue":o[1]||(o[1]=t=>e.manager=t),label:"Team Manager *",placeholder:"Team Manager Here",rules:e.rs("teamManager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),d("div",se,[i(a,{modelValue:e.category,"onUpdate:modelValue":o[2]||(o[2]=t=>e.category=t),label:"Team Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),d("div",re,[i(a,{modelValue:e.members,"onUpdate:modelValue":o[3]||(o[3]=t=>e.members=t),label:"Team Members *",placeholder:"Team Members Here",rules:e.rs("members",!0),multiple:"",searchable:"","text-by":"name","value-by":"id",options:e.props.employees.filter(t=>t.id!=e.manager)},{content:_(({value:t})=>[(h(!0),A(M,null,B(t,r=>(h(),w(u,{key:r,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":T=>e.deleteChip(r)},{default:_(()=>[U(H(r.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const ie=E(ee,[["render",ne]]);const de={components:{AppLayout:F,PageTitleBox:z,Pagination:N,Create:$,Edit:ie,CreateButton:G,RemoveEditButton:S},setup(){const g=s(!1),o=j(),m=s([]),e=s([]),f=s([]),p=s(!1),c=s([]),a=s(10),u=s("title"),b=[{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"title",sortable:!0},{key:"manager.name",label:"Manager",sortable:!0},{key:"category.title",label:"Category",sortable:!0},{key:"members",label:"Mambers",sortable:!0},{key:"action",thAlign:"right",tdAlign:"right"}],y=s("asc");axios.get(route("employee.index",{all:!0})).then(({data:v})=>e.value=v),axios.get(route("category.index",{all:!0})).then(({data:v})=>f.value=v);const t=async v=>{const x=route("team.index",{perPage:a.value,page:v}),{data:V}=await axios.get(x);c.value=V.links,m.value=addProtos(V.data,{action:!0,showEdit:!1}),g.value=!1};return t(1),{busy:g,showCreate:p,perPage:a,sortingOrder:y,items:m,columns:b,sortBy:u,push:v=>{p.value=!1,m.value.push(v)},replace:(v,x)=>{p.value=!1,m.value.splice(x,1,v)},fetchItems:t,employees:e,categories:f,remove:async(v,x)=>{if(!await I(v,"Team","title"))return null;try{const n=route("team.destroy",{team:v.id});await axios.delete(n),m.value.splice(x,1),L(o)}catch(n){console.log(n)}},links:c}}},me={class:"row mt-4"},ce={class:"flex md6"},ue={class:"item"},_e={class:"flex lg6"},pe={class:"item right"};function ve(g,o,m,e,f,p){const c=l("create-button"),a=l("page-title-box"),u=l("va-select"),b=l("va-icon"),y=l("va-input"),t=l("va-chip"),r=l("edit"),T=l("remove-edit-button"),O=l("va-data-table"),v=l("pagination"),x=l("create"),V=l("app-layout");return h(),w(V,{busy:e.busy},{default:_(()=>[d("div",null,[i(a,{title:"Teams"},{default:_(()=>[i(c,{title:"Add Team",onClick:o[0]||(o[0]=n=>e.showCreate=!0)})]),_:1})]),d("div",me,[d("div",ce,[d("div",ue,[i(u,{class:"flex mb-2 md6",label:"Per Page",modelValue:e.perPage,"onUpdate:modelValue":o[1]||(o[1]=n=>e.perPage=n),options:[10,20,30,40,50]},null,8,["modelValue"])])]),d("div",_e,[d("div",pe,[i(y,{class:"flex mb-2 md6",label:"Search"},{prepend:_(()=>[i(b,{class:"material-icons"},{default:_(()=>[U("search")]),_:1})]),_:1})])])]),i(O,{items:e.items,columns:e.columns,hoverable:!0,"sort-by":e.sortBy,"onUpdate:sortBy":o[2]||(o[2]=n=>e.sortBy=n),"sorting-order":e.sortingOrder,"onUpdate:sortingOrder":o[3]||(o[3]=n=>e.sortingOrder=n)},{"cell(members)":_(({rowData:n})=>[(h(!0),A(M,null,B(n.members,C=>(h(),w(t,{size:"small",key:C.id},{default:_(()=>[U(H(C.name),1)]),_:2},1024))),128))]),"cell(action)":_(({rowData:n,rowIndex:C})=>[i(T,{onEditClick:k=>n.showEdit=!0,onRemoveClick:k=>e.remove(n,C)},{default:_(()=>[i(r,{show:n.showEdit,"onUpdate:show":k=>n.showEdit=k,item:n,employees:e.employees,categories:e.categories,onReplace:k=>e.replace(k,C)},null,8,["show","onUpdate:show","item","employees","categories","onReplace"])]),_:2},1032,["onEditClick","onRemoveClick"])]),_:1},8,["items","columns","sort-by","sorting-order"]),i(v,{links:e.links,onPage:e.fetchItems},null,8,["links","onPage"]),i(x,{show:e.showCreate,"onUpdate:show":o[4]||(o[4]=n=>e.showCreate=n),employees:e.employees,categories:e.categories,onPush:e.push},null,8,["show","employees","categories","onPush"])]),_:1},8,["busy"])}const we=E(de,[["render",ve],["__scopeId","data-v-734c77bc"]]);export{we as default};
