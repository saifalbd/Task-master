import{a as M,S as R}from"./app-layout-3a0ab693.js";import{_ as U}from"./PageTitleBox-308ec643.js";import{_ as W,p as G,n as J,r as i,q as K,s as O,t as q,v as Q,h as B,w as n,e as r,f as d,i as t,b as l,j as v,c as _,x as b,F as x,y as X,u as Y,z as p,A as Z,B as $,C as ee,D as oe}from"./app-99bb498d.js";import{r as T}from"./api-661a824c.js";import{h as te}from"./moment-fbc5633a.js";import{C as se}from"./CreateButton-4474217c.js";import{C as ae}from"./Create-cb8d5e25.js";import"./FormDialog-b00b2303.js";import"./index-a1888b8c.js";const ne={components:{Plus:G,CreateButton:se,ArrowDown:J,AppLayout:M,PageTitleBox:U,statusBtnVue:R,AddTask:ae},setup(){const k=i(!1),u=i(!1),N=i([]),o=i([]),I=Y(),P=i([]),A=i([]),f=i([]),g=i([]),m=i([]),h=e=>te(e).fromNow(),S=e=>{I.push(e)},w=(e=null)=>{T(0,s=>{P.value=s},e),T(1,s=>{A.value=s},e),T(2,s=>{f.value=s},e),T(3,s=>{g.value=s},e),T(4,s=>{m.value=s},e)};w();const z=K(()=>[{title:"Pending Tasks",items:P.value},{title:"Accepted Tasks",items:A.value},{title:"Working Tasks",items:f.value},{title:"Submited Tasks",isSubmit:!0,items:g.value},{title:"Completed Tasks",items:m.value}]),y=i([]);axios.get(route("employeeProposal")).then(({data:e})=>{y.value=e});const V=async(e,s)=>{try{await axios.get(route("acceptProposal",{employee:e})),y.value.splice(s,1)}catch(a){console.error(a)}},D=async(e,s)=>{try{await axios.get(route("denyProposal",{employee:e})),y.value.splice(s,1)}catch(a){console.error(a)}},E=async(e,s,a,C)=>{try{const c=route("task.changeStatus",{task:s}),{data:j}=await axios.post(c,{status:e,notify:0});a.splice(C,1)}catch(c){console.error(c)}},L=e=>{P.value.push(e),u.value=!1};return O(()=>{q("employees",e=>{N.value=e}),q("categories",e=>{o.value=e})}),{atNow:h,go:S,push:L,changeStatus:E,doArchive:(e,s)=>{m.value.splice(s,1),axios.post(route("task.doArchive",{task:e.id}),{prop:"user_archive",do:e.user_archive?0:1})},loadTask:w,statusList:Q,busy:k,employeeProposals:y,Accepted:V,Deny:D,showCreate:u,tasks:z,employees:N,categories:o}}},H=k=>(ee("data-v-97365eda"),k=k(),oe(),k),le={class:"task-box-list"},re=["md"],ce={class:"box-card"},de={class:"card-header"},ie={class:"recent-task-list"},ue={class:"avatar-box"},_e=["src"],pe={class:"task-line"},me={class:"center"},ve={class:"el-dropdown-link"},ke=["onClick"],he={class:"right-side-bar"},ye=H(()=>t("div",{class:"card-header"},[t("span",null,"Employee Proposal")],-1)),fe={class:"employee-proposals"},ge=["onClick"],we={class:"line-one"},Ce={style:{"text-align":"center"}},be=H(()=>t("div",null,"Send you Employee Proposal as empoyeee",-1)),xe={class:"line-two"};function Te(k,u,N,o,I,P){const A=r("create-button"),f=r("arrow-down"),g=r("el-icon"),m=r("el-button"),h=r("el-dropdown-item"),S=r("el-dropdown-menu"),w=r("el-dropdown"),z=r("page-title-box"),y=r("el-avatar"),V=r("va-avatar"),D=r("el-link"),E=r("el-card"),L=r("add-task"),F=r("app-layout");return d(),B(F,{busy:o.busy},{default:n(()=>[t("div",null,[l(z,{title:"Home Board"},{default:n(()=>[l(A,{title:"Add Task",onClick:u[0]||(u[0]=e=>o.showCreate=!o.showCreate)}),l(w,null,{dropdown:n(()=>[l(S,null,{default:n(()=>[l(h,{onClick:u[1]||(u[1]=e=>o.loadTask(null))},{default:n(()=>[v("All Employees")]),_:1}),(d(!0),_(x,null,b(o.employees,e=>(d(),B(h,{key:e.id,onClick:s=>o.loadTask(e.id)},{default:n(()=>[v(p(e.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:n(()=>[l(m,{type:"primary",style:{"margin-left":"15px"}},{default:n(()=>[v(" Employees"),l(g,{class:"el-icon--right"},{default:n(()=>[l(f)]),_:1})]),_:1})]),_:1})]),_:1})]),t("div",{class:X(["home-page admin",{hasProposal:!!o.employeeProposals.length}])},[t("div",le,[(d(!0),_(x,null,b(o.tasks,(e,s)=>(d(),_("div",{sm:24,md:4.8,key:s},[t("div",ce,[t("div",de,[t("span",null,[t("b",null,p(e.title),1)])]),t("ul",ie,[(d(!0),_(x,null,b(e.items,(a,C)=>(d(),_("li",{key:C,style:Z({border:`1px solid ${a.category.color.border}`,color:a.category.color.text,backgroundColor:a.category.color.bg})},[t("div",ue,[l(y,{size:25},{default:n(()=>[t("img",{src:a.employee.model.avatar.url},null,8,_e)]),_:2},1024)]),t("div",pe,[t("b",null,p(a.employee.model.name),1),t("small",me,p(o.atNow(a.created_at)),1),l(w,null,{dropdown:n(()=>[l(S,null,{default:n(()=>[(d(!0),_(x,null,b(o.statusList.filter(c=>![0,1,2,3,6,7].includes(c.status)).filter(c=>c.status!=a.status),(c,j)=>(d(),B(h,{key:j,onClick:Pe=>o.changeStatus(c.status,a.id,e.items,C)},{default:n(()=>[v(p(c.title),1)]),_:2},1032,["onClick"]))),128)),a.status==4?(d(),B(h,{key:0,onClick:c=>o.doArchive(a,C)},{default:n(()=>[v(" Archive ")]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),default:n(()=>[t("span",ve,[l(g,{class:"el-icon--right"},{default:n(()=>[l(f)]),_:1})])]),_:2},1024)]),t("div",{class:"text-box",onClick:c=>o.go({name:"task.show",params:{id:a.id}})},p(a.title),9,ke)],4))),128))])])],8,re))),128))]),t("div",he,[l(E,{class:"box-card"},{header:n(()=>[ye]),default:n(()=>[t("ul",fe,[(d(!0),_(x,null,b(o.employeeProposals,(e,s)=>(d(),_("li",{key:s},[t("div",{class:"avatar-box",onClick:a=>o.go({name:"userProfile",params:{user:e.user.id}})},[l(V,{src:e.user.avatar.url,size:30},null,8,["src"])],8,ge),t("div",we,[t("div",null,[l(D,{underline:!1,onClick:a=>o.go({name:"userProfile",params:{user:e.user.id}})},{default:n(()=>[t("b",null,p(e.user.name),1)]),_:2},1032,["onClick"]),t("small",Ce,p(o.atNow(e.created_at)),1)]),be]),t("div",xe,[l(m,{size:"small",type:"primary",onClick:a=>o.Accepted(e,s)},{default:n(()=>[v(" Accepted ")]),_:2},1032,["onClick"]),l(m,{size:"small",type:"danger",onClick:a=>o.Deny(e,s)},{default:n(()=>[v(" Deny ")]),_:2},1032,["onClick"])])]))),128))])]),_:1})])],2),l(L,{show:o.showCreate,"onUpdate:show":u[2]||(u[2]=e=>o.showCreate=e),employees:o.employees,categories:o.categories,onPush:o.push},null,8,["show","employees","categories","onPush"])]),_:1},8,["busy"])}const Ie=W(ne,[["render",Te],["__scopeId","data-v-97365eda"]]);export{Ie as default};
