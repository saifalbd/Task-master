import{a as oe,S as le}from"./app-layout-62a20c1a.js";import{_ as ae}from"./PageTitleBox-34f8655b.js";import{P as se}from"./Pagination-0fa3f7a5.js";import{R as ne}from"./RemoveEditButton-6c02efb2.js";import{C as re}from"./Create-87c097d9.js";import{F as ie}from"./FormDialog-3370bb78.js";import{r as de}from"./index-dc654618.js";import{h as A}from"./moment-fbc5633a.js";import{_ as R,r as d,Z as ce,f as E,h as B,w as o,b as t,i,j as H,z as S,e as l,a8 as ue,aj as me,ak as _e,a7 as pe,ah as fe,al as ve,H as ye,aa as he,aq as be,ar as ke,as as ge,t as F,u as xe,l as Ce,a2 as we,a3 as Ve,c as O,x as W,F as q}from"./app-fc468544.js";import{C as Te}from"./CreateButton-8d1e5d7b.js";import{B as Ee}from"./BackButton-896ced05.js";import{u as Pe}from"./useToast-70ffcdc4.js";const Be={components:{FormDialog:ie},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},taskTypes:{type:Array,required:!0},item:{type:Object,required:!0}},setup(T,{emit:s}){let P=d(null),e=d(!1);const y=d(null);let C=d("");const v=d(null);let p=d(null),h=d(null);const b=d(A().format(dateFormat)),c=d(null),w=d(new Date),k=d(""),_=d([]);ce(T.item,m=>{C.value=m.title,h.value={id:m.employee.id,name:m.employee.model.name},p.value=m.category_id,b.value=m.start,c.value=m.end,k.value=m.description,v.value=m.type_id,P.value=m},{immediate:!0});const r=()=>{let m=A(w.value);return A().hour()!=m.hour()?m.format("h:mm"):""};return{props:T,form:y,emit:s,save:async()=>{var u;let m=route("task.update",{task:P.value.id});if(!await y.value.validate())return null;const n=new FormData;n.append("_method","PUT"),n.append("title",C.value),n.append("category",p.value),n.append("employee",(u=h.value)==null?void 0:u.id),n.append("start",b.value),n.append("end",c.value),n.append("endTime",r()),n.append("taskType",v.value),n.append("description",k.value),_.value.forEach((f,V)=>{n.append(`attachments[${V}]`,f)});try{const{data:f}=await axios.post(m,n);s("replace",addProtos(f,{action:!0,showEdit:!1}))}catch(f){console.error(f),validErorrs(f)}},rs:de,busy:e,taskType:v,title:C,start:b,end:c,endTime:w,employee:h,category:p,description:k,attachments:_}}},Se={class:"layout gutter--md"},Ue={class:"row align-content--center"},ze={class:"flex xs12 in-box"},Ae={class:"flex xs12 in-box"},He={class:"flex xs12 in-box"},Le={class:"flex xs12 in-box"},Fe={class:"flex xs4 in-box"},Oe={class:"flex xs4 in-box"},We={class:"flex xs4 in-box"},qe={class:"flex xs12 in-box"},Re={class:"flex xs12",style:{"min-height":"150px","margin-bottom":"50px"}};function je(T,s,P,e,y,C){const v=l("va-input"),p=l("va-select"),h=l("va-chip"),b=l("va-time-input"),c=l("va-file-upload"),w=l("QuillEditor"),k=l("va-form"),_=l("form-dialog");return E(),B(_,{show:e.props.show,"onUpdate:show":s[9]||(s[9]=r=>e.emit("update:show",r)),busy:e.busy,title:"Edit Task",onAdd:e.save,fullscreen:!0},{default:o(()=>[t(k,{ref:"form"},{default:o(()=>[i("div",Se,[i("div",Ue,[i("div",ze,[t(v,{modelValue:e.title,"onUpdate:modelValue":s[0]||(s[0]=r=>e.title=r),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),i("div",Ae,[t(p,{modelValue:e.taskType,"onUpdate:modelValue":s[1]||(s[1]=r=>e.taskType=r),label:"Task Type",placeholder:"Type Here","text-by":"title","value-by":"id",searchable:"",options:e.props.taskTypes},null,8,["modelValue","options"])]),i("div",He,[t(p,{modelValue:e.category,"onUpdate:modelValue":s[2]||(s[2]=r=>e.category=r),label:"Project Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",searchable:"",options:e.props.categories},null,8,["modelValue","rules","options"])]),i("div",Le,[t(p,{modelValue:e.employee,"onUpdate:modelValue":s[3]||(s[3]=r=>e.employee=r),label:"Task Employee *",placeholder:"Task Employee Here",rules:e.rs("member",!0),searchable:"","text-by":"name",options:e.props.employees},{content:o(({value:r})=>[t(h,{size:"small",class:"mr-1 my-1"},{default:o(()=>[H(S(r.name),1)]),_:2},1024)]),_:1},8,["modelValue","rules","options"])]),i("div",Fe,[t(v,{modelValue:e.start,"onUpdate:modelValue":s[4]||(s[4]=r=>e.start=r),label:"Start *",type:"date",placeholder:"Start Here",rules:e.rs("start",!0)},null,8,["modelValue","rules"])]),i("div",Oe,[t(v,{modelValue:e.end,"onUpdate:modelValue":s[5]||(s[5]=r=>e.end=r),type:"date",label:"Dead Line *",placeholder:"Dead Line Here",rules:e.rs("dead line",!0)},null,8,["modelValue","rules"])]),i("div",We,[t(b,{label:"End Time",modelValue:e.endTime,"onUpdate:modelValue":s[6]||(s[6]=r=>e.endTime=r)},null,8,["modelValue"])]),i("div",qe,[t(c,{modelValue:e.attachments,"onUpdate:modelValue":s[7]||(s[7]=r=>e.attachments=r),dropzone:""},null,8,["modelValue"])]),i("div",Re,[t(w,{theme:"snow",toolbar:"minimal",contentType:"html",content:e.description,"onUpdate:content":s[8]||(s[8]=r=>e.description=r),placeholder:"Description Html Contant"},null,8,["content"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const De=R(Be,[["render",je]]);const Me={components:{AppLayout:oe,PageTitleBox:ae,Pagination:se,Create:re,EditVue:De,Edit:ue,List:me,Box:_e,CreateButton:Te,RemoveEditButton:ne,StatusBtn:le,Delete:pe,More:fe,Search:ve,Collection:ye,Expand:he,Download:be,Star:ke,StarFilled:ge,BackButton:Ee},setup(){const T=d(!1),s=d(!0),P=Pe(),e=xe(),y=d([]),C=d([]),v=d([]),p=d(!1),h=d([]),b=d(50),c=[{key:"user_star",label:"Star",sortable:!0},{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"title",sortable:!0},{key:"category.title",label:"Category",sortable:!0},{key:"employee",label:"Employee",sortable:!0},{key:"start",label:"Start",sortable:!0},{key:"end",label:"Dead Line",sortable:!0},{key:"status",sortable:!0},{key:"action",thAlign:"right",tdAlign:"right"}],w=d("asc");F("employees",n=>{C.value=n}),F("categories",n=>{v.value=n});const k=async n=>{try{const u=route("task.archives",{perPage:b.value,page:n}),{data:f}=await axios.get(u);h.value=f.links,y.value=Ce.sortBy(addProtos(f.data,{action:!0,showEdit:!1}),"user_star").reverse()}catch(u){console.error(u)}s.value=!1};return k(1),{busy:s,showCreate:p,perPage:b,sortingOrder:w,items:y,columns:c,push:n=>{p.value=!1,y.value.push(n)},replace:(n,u)=>{p.value=!1,y.value.splice(u,1,n)},fetchItems:k,employees:C,categories:v,remove:async(n,u)=>{if(!await we(n,"Task","title"))return null;try{const V=route("task.destroy",{task:n.id});await axios.delete(V),y.value.splice(u,1),Ve(P)}catch(V){console.log(V)}},addStar:n=>{n.user_star=!n.user_star,axios.post(route("task.changeStar",{task:n.id}),{prop:"user_star",star:n.user_star?0:1})},doArchive:(n,u)=>{y.value.splice(u,1),axios.post(route("task.doArchive",{task:n.id}),{prop:"user_archive",do:n.user_archive?0:1})},links:h,router:e,isCardWise:T}}},Ne={class:"filter-row mt-2"},Qe={class:"left-side"},Ie={class:"item"},Ze={class:"right-side"},Ge={class:"item right mr-3"},Je={class:"item right"},Ke=["innerHTML"],Xe={class:"ml-1"};function Ye(T,s,P,e,y,C){const v=l("back-button"),p=l("page-title-box"),h=l("el-option"),b=l("collection"),c=l("el-icon"),w=l("el-select"),k=l("list"),_=l("el-button"),r=l("box"),U=l("el-button-group"),m=l("search"),z=l("el-input"),n=l("el-divider"),u=l("el-descriptions-item"),f=l("status-btn"),V=l("delete"),j=l("more"),D=l("el-descriptions"),M=l("el-card"),N=l("el-col"),Q=l("el-row"),L=l("el-link"),I=l("star-filled"),Z=l("el-avatar"),G=l("download"),J=l("expand"),K=l("edit"),X=l("edit-vue"),Y=l("va-data-table"),$=l("pagination"),ee=l("create"),te=l("app-layout");return E(),B(te,{busy:e.busy},{default:o(()=>[i("div",null,[t(p,{title:"Task Archives"},{default:o(()=>[t(v)]),_:1})]),i("div",Ne,[i("div",Qe,[i("div",Ie,[t(w,{modelValue:e.perPage,"onUpdate:modelValue":s[0]||(s[0]=a=>e.perPage=a),placeholder:"Per Page"},{prefix:o(()=>[t(c,{class:"el-input__icon"},{default:o(()=>[t(b)]),_:1})]),default:o(()=>[(E(),O(q,null,W([10,20,30,40,50,70,100],a=>t(h,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),i("div",Ze,[i("div",Ge,[t(U,null,{default:o(()=>[t(_,{type:e.isCardWise?"info":"primary",onClick:s[1]||(s[1]=a=>e.isCardWise=!1)},{default:o(()=>[t(c,null,{default:o(()=>[t(k)]),_:1})]),_:1},8,["type"]),t(_,{type:e.isCardWise?"primary":"info",onClick:s[2]||(s[2]=a=>e.isCardWise=!0)},{default:o(()=>[t(c,null,{default:o(()=>[t(r)]),_:1})]),_:1},8,["type"])]),_:1})]),i("div",Je,[t(z,{placeholder:"Type something"},{prefix:o(()=>[t(c,{class:"el-input__icon"},{default:o(()=>[t(m)]),_:1})]),_:1})])])]),t(n),e.isCardWise?(E(),B(Q,{key:0,class:"card-list",gutter:24},{default:o(()=>[(E(!0),O(q,null,W(e.items,(a,g)=>(E(),B(N,{sm:24,md:12,key:g},{default:o(()=>[t(M,null,{default:o(()=>[t(D,{title:a.title,direction:"horizontal",column:1,size:"small",border:""},{default:o(()=>[t(u,{label:"Assgned To:"},{default:o(()=>[H(S(a.employee.model.name),1)]),_:2},1024),t(u,{label:"Dead Line:"},{default:o(()=>[H(S(a.end),1)]),_:2},1024),t(u,{label:"Status:"},{default:o(()=>[t(f,{status:a.status,size:"small"},null,8,["status"])]),_:2},1024),t(u,{label:"Delete:"},{default:o(()=>[t(_,{size:"small",type:"danger",plain:"",onClick:x=>e.remove(a,g)},{default:o(()=>[t(c,null,{default:o(()=>[t(V)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),t(u,{label:"View:"},{default:o(()=>[t(_,{size:"small",type:"info",plain:"",onClick:x=>e.router.push({name:"task.show",params:{id:a.id}})},{default:o(()=>[t(c,null,{default:o(()=>[t(j)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title"]),i("div",{class:"description",innerHTML:a.description},null,8,Ke)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(E(),B(Y,{key:1,items:e.items,columns:e.columns,hoverable:!0,"sorting-order":e.sortingOrder,"onUpdate:sortingOrder":s[3]||(s[3]=a=>e.sortingOrder=a)},{"cell(title)":o(({rowData:a})=>[t(L,{onClick:g=>T.go({name:"task.show",params:{id:a.id}})},{default:o(()=>[i("b",null,S(a.title),1)]),_:2},1032,["onClick"])]),"cell(user_star)":o(({rowData:a})=>[t(_,{onClick:g=>e.addStar(a),size:"small",type:a.user_star?"warning":"",plain:"",round:""},{default:o(()=>[t(c,null,{default:o(()=>[t(I)]),_:1})]),_:2},1032,["onClick","type"])]),"cell(employee)":o(({rowData:a})=>[t(L,{underline:!1,onClick:g=>e.router.push({name:"userProfile",params:{user:a.employee.model.id}})},{default:o(()=>[t(Z,{size:25,src:a.employee.model.avatar.url},null,8,["src"]),i("b",Xe,S(a.employee.model.name),1)]),_:2},1032,["onClick"])]),"cell(status)":o(({value:a})=>[t(f,{status:a,size:"small"},null,8,["status"])]),"cell(action)":o(({rowData:a,rowIndex:g})=>[i("div",null,[t(U,null,{default:o(()=>[t(_,{type:"primary",size:"small",title:"Archive",onClick:x=>e.doArchive(a,g)},{default:o(()=>[t(c,null,{default:o(()=>[t(G)]),_:1})]),_:2},1032,["onClick"]),t(_,{type:"primary",size:"small",onClick:x=>e.router.push({name:"task.show",params:{id:a.id}}),title:"Show"},{default:o(()=>[t(c,null,{default:o(()=>[t(J)]),_:1})]),_:2},1032,["onClick"]),t(_,{type:"primary",size:"small",onClick:x=>a.showEdit=!0,title:"edit"},{default:o(()=>[t(c,null,{default:o(()=>[t(K)]),_:1})]),_:2},1032,["onClick"]),t(_,{type:"danger",size:"small",onClick:x=>e.remove(a,g),title:"remove"},{default:o(()=>[t(c,null,{default:o(()=>[t(V)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),t(X,{show:a.showEdit,"onUpdate:show":x=>a.showEdit=x,item:a,employees:e.employees,categories:e.categories,onReplace:x=>e.replace(x,g)},null,8,["show","onUpdate:show","item","employees","categories","onReplace"])])]),_:1},8,["items","columns","sorting-order"])),t($,{links:e.links,onPage:e.fetchItems},null,8,["links","onPage"]),t(ee,{show:e.showCreate,"onUpdate:show":s[4]||(s[4]=a=>e.showCreate=a),employees:e.employees,categories:e.categories,onPush:e.push},null,8,["show","employees","categories","onPush"])]),_:1},8,["busy"])}const ut=R(Me,[["render",Ye],["__scopeId","data-v-b20e713f"]]);export{ut as default};
