import{a as M,S as R}from"./app-layout-88335d0e.js";import{_ as U}from"./PageTitleBox-f334fc59.js";import{_ as W,p as G,n as J,r as d,q as K,s as O,t as j,v as Q,h as B,w as a,e as r,f as i,i as o,b as n,c as _,x,F as b,j as w,y as X,u as Y,z as p,A as Z,B as $,C as ee,D as oe}from"./app-af086469.js";import{r as P}from"./api-5314060c.js";import{h as te}from"./moment-fbc5633a.js";import{C as se}from"./CreateButton-fe7171b5.js";import{C as ae}from"./Create-cfec5ccd.js";import"./FormDialog-ae27619d.js";import"./index-d1679d20.js";const ne={components:{Plus:G,CreateButton:se,ArrowDown:J,AppLayout:M,PageTitleBox:U,statusBtnVue:R,AddTask:ae},setup(){const k=d(!1),m=d(!1),N=d([]),t=d([]),I=Y(),T=d([]),C=d([]),f=d([]),v=d([]),h=d([]),A=e=>te(e).fromNow(),S=e=>{I.push(e)};P(0,e=>{T.value=e}),P(1,e=>{C.value=e}),P(2,e=>{f.value=e}),P(3,e=>{v.value=e}),P(4,e=>{h.value=e});const z=K(()=>[{title:"Pending Tasks",items:T.value},{title:"Accepted Tasks",items:C.value},{title:"Working Tasks",items:f.value},{title:"Submited Tasks",isSubmit:!0,items:v.value},{title:"Completed Tasks",items:h.value}]),g=d([]);axios.get(route("employeeProposal")).then(({data:e})=>{g.value=e});const V=async(e,s)=>{try{await axios.get(route("acceptProposal",{employee:e})),g.value.splice(s,1)}catch(c){console.error(c)}},D=async(e,s)=>{try{await axios.get(route("denyProposal",{employee:e})),g.value.splice(s,1)}catch(c){console.error(c)}},L=async(e,s,c,l)=>{try{const y=route("task.changeStatus",{task:s}),{data:u}=await axios.post(y,{status:e,notify:0});c.splice(l,1)}catch(y){console.error(y)}},E=e=>{T.value.push(e),m.value=!1};return O(()=>{j("employees",e=>{N.value=e}),j("categories",e=>{t.value=e})}),{atNow:A,go:S,push:E,changeStatus:L,doArchive:(e,s)=>{h.value.splice(s,1),axios.post(route("task.doArchive",{task:e.id}),{prop:"user_archive",do:e.user_archive?0:1})},statusList:Q,busy:k,employeeProposals:g,Accepted:V,Deny:D,showCreate:m,tasks:z,employees:N,categories:t}}},q=k=>(ee("data-v-4f03551e"),k=k(),oe(),k),le={class:"task-box-list"},re=["md"],ce={class:"box-card"},ie={class:"card-header"},de={class:"recent-task-list"},ue={class:"avatar-box"},_e=["src"],pe={class:"task-line"},me={class:"center"},ve={class:"el-dropdown-link"},he=["onClick"],ye={class:"right-side-bar"},ke=q(()=>o("div",{class:"card-header"},[o("span",null,"Employee Proposal")],-1)),fe={class:"employee-proposals"},ge=["onClick"],we={class:"line-one"},Ce={style:{"text-align":"center"}},xe=q(()=>o("div",null,"Send you Employee Proposal as empoyeee",-1)),be={class:"line-two"};function Pe(k,m,N,t,I,T){const C=r("arrow-down"),f=r("el-icon"),v=r("el-button"),h=r("el-dropdown-item"),A=r("el-dropdown-menu"),S=r("el-dropdown"),z=r("page-title-box"),g=r("plus"),V=r("el-avatar"),D=r("va-avatar"),L=r("el-link"),E=r("el-card"),F=r("add-task"),e=r("app-layout");return i(),B(e,{busy:t.busy},{default:a(()=>[o("div",null,[n(z,{title:"Home Board"},{default:a(()=>[n(S,null,{dropdown:a(()=>[n(A,null,{default:a(()=>[(i(!0),_(b,null,x(t.employees,s=>(i(),B(h,{key:s.id,onClick:c=>t.go({name:"userProfile",params:{user:s.user_id}})},{default:a(()=>[w(p(s.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:a(()=>[n(v,{type:"primary",style:{"margin-left":"15px"}},{default:a(()=>[w(" Employees"),n(f,{class:"el-icon--right"},{default:a(()=>[n(C)]),_:1})]),_:1})]),_:1})]),_:1})]),o("div",{class:X(["home-page admin",{hasProposal:!!t.employeeProposals.length}])},[o("div",le,[(i(!0),_(b,null,x(t.tasks,(s,c)=>(i(),_("div",{sm:24,md:4.8,key:c},[o("div",ce,[o("div",ie,[o("span",null,[o("b",null,p(s.title),1)]),n(v,{onClick:m[0]||(m[0]=l=>t.showCreate=!0)},{default:a(()=>[n(f,{class:"el-icon--right"},{default:a(()=>[n(g)]),_:1})]),_:1})]),o("ul",de,[(i(!0),_(b,null,x(s.items,(l,y)=>(i(),_("li",{key:y,style:Z({border:`1px solid ${l.category.color.border}`,color:l.category.color.text,backgroundColor:l.category.color.bg})},[o("div",ue,[n(V,{size:25},{default:a(()=>[o("img",{src:l.employee.model.avatar.url},null,8,_e)]),_:2},1024)]),o("div",pe,[o("b",null,p(l.employee.model.name),1),o("small",me,p(t.atNow(l.created_at)),1),n(S,null,{dropdown:a(()=>[n(A,null,{default:a(()=>[(i(!0),_(b,null,x(t.statusList.filter(u=>![0,1,2,3,6,7].includes(u.status)).filter(u=>u.status!=l.status),(u,H)=>(i(),B(h,{key:H,onClick:Te=>t.changeStatus(u.status,l.id,s.items,y)},{default:a(()=>[w(p(u.title),1)]),_:2},1032,["onClick"]))),128)),l.status==4?(i(),B(h,{key:0,onClick:u=>t.doArchive(l,y)},{default:a(()=>[w(" Archive ")]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),default:a(()=>[o("span",ve,[n(f,{class:"el-icon--right"},{default:a(()=>[n(C)]),_:1})])]),_:2},1024)]),o("div",{class:"text-box",onClick:u=>t.go({name:"task.show",params:{id:l.id}})},p(l.title),9,he)],4))),128))])])],8,re))),128))]),o("div",ye,[n(E,{class:"box-card"},{header:a(()=>[ke]),default:a(()=>[o("ul",fe,[(i(!0),_(b,null,x(t.employeeProposals,(s,c)=>(i(),_("li",{key:c},[o("div",{class:"avatar-box",onClick:l=>t.go({name:"userProfile",params:{user:s.user.id}})},[n(D,{src:s.user.avatar.url,size:30},null,8,["src"])],8,ge),o("div",we,[o("div",null,[n(L,{underline:!1,onClick:l=>t.go({name:"userProfile",params:{user:s.user.id}})},{default:a(()=>[o("b",null,p(s.user.name),1)]),_:2},1032,["onClick"]),o("small",Ce,p(t.atNow(s.created_at)),1)]),xe]),o("div",be,[n(v,{size:"small",type:"primary",onClick:l=>t.Accepted(s,c)},{default:a(()=>[w(" Accepted ")]),_:2},1032,["onClick"]),n(v,{size:"small",type:"danger",onClick:l=>t.Deny(s,c)},{default:a(()=>[w(" Deny ")]),_:2},1032,["onClick"])])]))),128))])]),_:1})])],2),n(F,{show:t.showCreate,"onUpdate:show":m[1]||(m[1]=s=>t.showCreate=s),employees:t.employees,categories:t.categories,onPush:t.push},null,8,["show","employees","categories","onPush"])]),_:1},8,["busy"])}const Ie=W(ne,[["render",Pe],["__scopeId","data-v-4f03551e"]]);export{Ie as default};
