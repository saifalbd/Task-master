import{a as de,S as ce}from"./app-layout-8b513eb6.js";import{d as ue,Z as pe,$ as _e,r as p,_ as ee,f as z,h as R,w as t,i as c,y as me,b as e,j as k,z as E,e as s,a6 as q,a7 as Z,ap as G,ai as ye,aj as fe,ag as ve,ak as ke,H as he,a9 as be,aq as ge,ar as Ce,Y as we,t as J,u as Te,l as O,a1 as xe,a2 as Ve,c as K,x as Q,F as X}from"./app-69e9ea5d.js";import{_ as Ee}from"./PageTitleBox-a1d30c1a.js";import{P as Pe}from"./Pagination-8d48af23.js";import{R as ze}from"./RemoveEditButton-e0afc09c.js";import{C as Ae}from"./Create-3d2c8b73.js";import{E as Se}from"./Edit-7e1495e2.js";import{C as Ne}from"./CreateButton-49ff625b.js";import{h as $}from"./moment-fbc5633a.js";import{u as Be}from"./useToast-5f268dc1.js";import"./FormDialog-7d1a2045.js";import"./index-a5a6905c.js";const Ue=ue({components:{CircleCloseFilled:pe,Pointer:_e},model:{prop:"show",event:"change"},props:{show:{type:Boolean,default:!0},taskTypes:{type:Array,required:!0}},setup(u,{emit:n}){const h=p(null),o=p(!1),y=p(null),f=d=>{y.value=d.id,h.value=d.value},T=async d=>{try{const _=route("taskType.destroy",{task_type:d});await axios.delete(_),n("removeType",d)}catch(_){console.error(_)}},b=async()=>{if(!h.value)return null;try{if(y.value){const d=route("taskType.update",{taskType:y.value}),{data:_}=await axios.put(d,{title:h.value});n("pushType",_),y.value=null}else{const d=route("taskType.store"),{data:_}=await axios.post(d,{title:h.value});n("pushType",_),y.value=null}h.value=""}catch(d){console.error(d)}},r=()=>{n("update:show",!1)};return{busy:o,props:u,type:h,updateId:y,setEdit:f,remove:T,submit:b,close:r,add:()=>{n("add",!0)},handleClose:d=>{d(),r()}}}}),Le={class:"my-header",style:{display:"flex","justify-content":"space-between"}},Re=["id"],Ie={class:"card-header",style:{display:"flex","justify-content":"space-between"}};function Fe(u,n,h,o,y,f){const T=s("CircleCloseFilled"),b=s("el-icon"),r=s("el-button"),m=s("el-input"),A=s("el-card"),d=s("el-col"),_=s("el-table-column"),S=s("el-table"),B=s("el-row"),U=s("el-dialog");return z(),R(U,{modelValue:u.props.show,"onUpdate:modelValue":n[1]||(n[1]=v=>u.props.show=v),"before-close":u.handleClose,"show-close":!1},{header:t(({close:v,titleId:P,titleClass:L})=>[c("div",Le,[c("h4",{id:P,class:me(L)},"Task Types",10,Re),e(r,{type:"danger",size:"small",onClick:v},{default:t(()=>[e(b,{class:"el-icon--left"},{default:t(()=>[e(T)]),_:1}),k(" Close ")]),_:2},1032,["onClick"])])]),footer:t(()=>[]),default:t(()=>[e(B,null,{default:t(()=>[e(d,{span:24},{default:t(()=>[e(A,{class:"box-card"},{header:t(()=>[c("div",Ie,[c("span",null,E(u.updateId?"Edit":"Add")+" Type",1),e(r,{type:"primary",onClick:u.submit},{default:t(()=>[k(E(u.updateId?"Update":"Add"),1)]),_:1},8,["onClick"])])]),default:t(()=>[e(m,{modelValue:u.type,"onUpdate:modelValue":n[0]||(n[0]=v=>u.type=v),placeholder:"Please input"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:24,style:{"margin-top":"20px"}},{default:t(()=>[e(S,{data:u.props.taskTypes,style:{width:"100%"}},{default:t(()=>[e(_,{prop:"title",label:"Title"}),e(_,{fixed:"right",label:"Operations",width:"120"},{default:t(({row:v})=>[e(r,{link:"",type:"primary",size:"small",onClick:P=>u.remove(v.id)},{default:t(()=>[k("Delete")]),_:2},1032,["onClick"]),e(r,{link:"",type:"primary",size:"small",onClick:P=>u.setEdit(v)},{default:t(()=>[k("Edit")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["modelValue","before-close"])}const Me=ee(Ue,[["render",Fe],["__scopeId","data-v-89668bbf"]]);const Oe={components:{TaskTypesVue:Me,Delete:q,Edit:Z,Download:G,AppLayout:de,PageTitleBox:Ee,Pagination:Pe,Create:Ae,EditVue:Se,List:ye,Box:fe,CreateButton:Ne,RemoveEditButton:ze,StatusBtn:ce,More:ve,Search:ke,Collection:he,Expand:be,Star:ge,StarFilled:Ce},setup(){const u=p(!1),n=p(!0),h=Be(),o=Te(),y=p(),f=p([]),T=p([]),b=p([]),r=p([]),m=p(!1),A=p(!1),d=p([]),_=p("");we(_,a=>{a?f.value=y.value.filter(i=>O.lowerCase(i.title).search(O.lowerCase(a))>-1):f.value=y.value});const S=p(50),B=[{key:"user_star",label:"Star",sortable:!0},{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"title",sortable:!0},{key:"category.title",label:"Category",sortable:!0},{key:"typeName",label:"Type",sortable:!0},{key:"employeeName",label:"Employee",sortable:!0},{key:"start",label:"Start",sortable:!0},{key:"end",label:"Dead Line",sortable:!0},{key:"created_at",label:"AtNow",sortable:!0},{key:"status",sortable:!0},{key:"action",thAlign:"right",tdAlign:"right"}],U=p("asc"),v=a=>{o.push(a)};axios.get(route("taskType.index")).then(({data:a})=>{r.value=a});const P=a=>{let i=r.value.find(g=>g.title==a.title);i?i.title=a.title:r.value.push(a)},L=a=>{const i=r.value.findIndex(g=>g.id==a);i&&r.value.splice(i,1)};J("employees",a=>{T.value=a}),J("categories",a=>{b.value=a});const I=async a=>{try{const i=route("task.index",{perPage:S.value,page:a}),{data:g}=await axios.get(i);d.value=g.links;const x=O.sortBy(addProtos(g.data,{action:!0,showEdit:!1}),"user_star").reverse().map(V=>(V.employeeName=V.employee.model.name,V.typeName=V.type?V.type.title:"",V));f.value=x,y.value=x}catch(i){console.error(i)}n.value=!1};return I(1),{Delete:q,Edit:Z,Download:G,busy:n,search:_,showTaskType:A,showCreate:m,perPage:S,sortingOrder:U,items:f,columns:B,endDate:a=>{if(a.end_time){let i=`${a.end} ${a.end_time}`;return console.log(i),$(i).format("MMM Do YY h:mm a")}else return a.end},removeType:L,pushType:P,push:a=>{m.value=!1,f.value.push(a)},replace:(a,i)=>{m.value=!1,f.value.splice(i,1,a)},fetchItems:I,employees:T,categories:b,taskTypes:r,remove:async(a,i)=>{if(!await xe(a,"Task","title"))return null;try{const x=route("task.destroy",{task:a.id});await axios.delete(x),f.value.splice(i,1),Ve(h)}catch(x){console.log(x)}},addStar:a=>{a.user_star=!a.user_star,axios.post(route("task.changeStar",{task:a.id}),{prop:"user_star",star:a.user_star?1:0})},doArchive:(a,i)=>{f.value.splice(i,1),axios.post(route("task.doArchive",{task:a.id}),{prop:"user_archive",do:a.user_archive?0:1})},atNow:a=>$(a).fromNow(),links:d,router:o,go:v,isCardWise:u}}},We={class:"filter-row mt-2"},De={class:"left-side"},je={class:"item"},He={class:"right-side"},Ye={class:"item right mr-3"},qe={class:"item right"},Ze=["innerHTML"],Ge={class:"ml-1"},Je={style:{"min-width":"100px"}};function Ke(u,n,h,o,y,f){const T=s("create-button"),b=s("list"),r=s("el-icon"),m=s("el-button"),A=s("download"),d=s("page-title-box"),_=s("el-option"),S=s("collection"),B=s("el-select"),U=s("box"),v=s("el-button-group"),P=s("search"),L=s("el-input"),I=s("el-divider"),N=s("el-descriptions-item"),F=s("status-btn"),W=s("delete"),D=s("more"),j=s("el-descriptions"),H=s("el-card"),Y=s("el-col"),a=s("el-row"),i=s("el-link"),g=s("star-filled"),x=s("el-avatar"),V=s("expand"),M=s("el-dropdown-item"),te=s("el-dropdown-menu"),oe=s("el-dropdown"),le=s("edit-vue"),se=s("va-data-table"),ae=s("pagination"),ne=s("create"),re=s("task-types-vue"),ie=s("app-layout");return z(),R(ie,{busy:o.busy},{default:t(()=>[c("div",null,[e(d,{title:"Task"},{default:t(()=>[e(T,{title:"Add Task",onClick:n[0]||(n[0]=l=>o.showCreate=!0)}),e(m,{type:"primary",onClick:n[1]||(n[1]=l=>o.showTaskType=!o.showTaskType)},{default:t(()=>[e(r,null,{default:t(()=>[e(b)]),_:1}),k(" Task Types ")]),_:1}),e(m,{type:"primary",onClick:n[2]||(n[2]=l=>o.router.push({name:"task.archive"}))},{default:t(()=>[e(r,null,{default:t(()=>[e(A)]),_:1}),k(" Archives ")]),_:1})]),_:1})]),c("div",We,[c("div",De,[c("div",je,[e(B,{modelValue:o.perPage,"onUpdate:modelValue":n[3]||(n[3]=l=>o.perPage=l),placeholder:"Per Page"},{prefix:t(()=>[e(r,{class:"el-input__icon"},{default:t(()=>[e(S)]),_:1})]),default:t(()=>[(z(),K(X,null,Q([10,20,30,40,50,70,100],l=>e(_,{key:l,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),c("div",He,[c("div",Ye,[e(v,null,{default:t(()=>[e(m,{type:o.isCardWise?"info":"primary",onClick:n[4]||(n[4]=l=>o.isCardWise=!1)},{default:t(()=>[e(r,null,{default:t(()=>[e(b)]),_:1})]),_:1},8,["type"]),e(m,{type:o.isCardWise?"primary":"info",onClick:n[5]||(n[5]=l=>o.isCardWise=!0)},{default:t(()=>[e(r,null,{default:t(()=>[e(U)]),_:1})]),_:1},8,["type"])]),_:1})]),c("div",qe,[e(L,{placeholder:"Type something",modelValue:o.search,"onUpdate:modelValue":n[6]||(n[6]=l=>o.search=l)},{prefix:t(()=>[e(r,{class:"el-input__icon"},{default:t(()=>[e(P)]),_:1})]),_:1},8,["modelValue"])])])]),e(I),o.isCardWise?(z(),R(a,{key:0,class:"card-list",gutter:24},{default:t(()=>[(z(!0),K(X,null,Q(o.items,(l,C)=>(z(),R(Y,{sm:24,md:12,key:C},{default:t(()=>[e(H,null,{default:t(()=>[e(j,{title:l.title,direction:"horizontal",column:1,size:"small",border:""},{default:t(()=>[e(N,{label:"Assgned To:"},{default:t(()=>[k(E(l.employee.model.name),1)]),_:2},1024),e(N,{label:"Dead Line:"},{default:t(()=>[k(E(l.end),1)]),_:2},1024),e(N,{label:"Status:"},{default:t(()=>[e(F,{status:l.status,size:"small"},null,8,["status"])]),_:2},1024),e(N,{label:"Delete:"},{default:t(()=>[e(m,{size:"small",type:"danger",plain:"",onClick:w=>o.remove(l,C)},{default:t(()=>[e(r,null,{default:t(()=>[e(W)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(N,{label:"View:"},{default:t(()=>[e(m,{size:"small",type:"info",plain:"",onClick:w=>o.router.push({name:"task.show",params:{id:l.id}})},{default:t(()=>[e(r,null,{default:t(()=>[e(D)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title"]),c("div",{class:"description",innerHTML:l.description},null,8,Ze)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(z(),R(se,{key:1,items:o.items,columns:o.columns,hoverable:!0,"sorting-order":o.sortingOrder,"onUpdate:sortingOrder":n[7]||(n[7]=l=>o.sortingOrder=l)},{"cell(created_at)":t(({value:l})=>[c("span",null,E(o.atNow(l)),1)]),"cell(end)":t(({rowData:l})=>[c("span",null,E(o.endDate(l)),1)]),"cell(title)":t(({rowData:l})=>[e(i,{onClick:C=>o.go({name:"task.show",params:{id:l.id}})},{default:t(()=>[c("b",null,E(l.title),1)]),_:2},1032,["onClick"])]),"cell(user_star)":t(({rowData:l})=>[e(m,{onClick:C=>o.addStar(l),size:"small",type:l.user_star?"warning":"",plain:"",round:""},{default:t(()=>[e(r,null,{default:t(()=>[e(g)]),_:1})]),_:2},1032,["onClick","type"])]),"cell(employeeName)":t(({rowData:l})=>[e(i,{underline:!1,onClick:C=>o.router.push({name:"userProfile",params:{user:l.employee.model.id}})},{default:t(()=>[e(x,{size:25,src:l.employee.model.avatar.url},null,8,["src"]),c("b",Ge,E(l.employee.model.name),1)]),_:2},1032,["onClick"])]),"cell(status)":t(({value:l})=>[e(F,{status:l,size:"small"},null,8,["status"])]),"cell(action)":t(({rowData:l,rowIndex:C})=>[c("div",Je,[e(oe,{"split-button":"",type:"info",size:"small"},{dropdown:t(()=>[e(te,null,{default:t(()=>[e(M,{icon:o.Edit,onClick:w=>l.showEdit=!0},{default:t(()=>[k("Edit")]),_:2},1032,["icon","onClick"]),e(M,{icon:o.Delete,onClick:w=>o.remove(l,C)},{default:t(()=>[k("Remove")]),_:2},1032,["icon","onClick"]),e(M,{icon:o.Download,onClick:w=>o.doArchive(l,C)},{default:t(()=>[k("Archive")]),_:2},1032,["icon","onClick"])]),_:2},1024)]),default:t(()=>[e(r,{size:20,onClick:w=>o.go({name:"task.show",params:{id:l.id}})},{default:t(()=>[e(V)]),_:2},1032,["onClick"])]),_:2},1024),e(le,{show:l.showEdit,"onUpdate:show":w=>l.showEdit=w,item:l,employees:o.employees,categories:o.categories,taskTypes:o.taskTypes,onReplace:w=>o.replace(w,C)},null,8,["show","onUpdate:show","item","employees","categories","taskTypes","onReplace"])])]),_:1},8,["items","columns","sorting-order"])),e(ae,{links:o.links,onPage:o.fetchItems},null,8,["links","onPage"]),e(ne,{show:o.showCreate,"onUpdate:show":n[8]||(n[8]=l=>o.showCreate=l),employees:o.employees,categories:o.categories,taskTypes:o.taskTypes,onPush:o.push},null,8,["show","employees","categories","taskTypes","onPush"]),e(re,{show:o.showTaskType,"onUpdate:show":n[9]||(n[9]=l=>o.showTaskType=l),taskTypes:o.taskTypes,onPushType:o.pushType,onRemoveType:o.removeType},null,8,["show","taskTypes","onPushType","onRemoveType"])]),_:1},8,["busy"])}const dt=ee(Oe,[["render",Ke],["__scopeId","data-v-9493357c"]]);export{dt as default};
