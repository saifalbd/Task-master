import{_ as V,d as E,o as P,m as R,r as N,a as h,c as $,b as s,w as a,l as F,e as t,f as k,g as q,h as B,i,j as y,u as C,E as I,k as z}from"./app-15300521.js";const D=E({components:{Open:P},setup(){const e=R(),n=C(),m=N(!1),v=N(),p=h({userName:"",password:""}),_=h({userName:"",password:""}),f=h({userName:[{required:!0,message:"Email Must be Required",trigger:"change"}],password:[{required:!0,message:"Password Must be Required",trigger:"change"}]}),u=c=>{I({title:"Warning",message:c,type:"warning"})};return{ruleForm:_,rules:f,errors:p,ruleFormRef:v,busy:m,login:async c=>{await c.validate(async(w,g)=>{if(w)try{const l="/login";m.value=!0;const{data:r}=await axios.post(l,{email:_.userName,password:_.password});e.addToken(r.token),e.addUser(r.user),console.log(r),n.push({name:"home"})}catch(l){console.error(l);const r=l==null?void 0:l.response;if(r&&r.status==422){const d=r.data.errors;if(F.hasIn(d,"loginEmail")){let o=d.loginEmail[0];p.userName=o,u(o)}if(F.hasIn(d,"loginPassword")){let o=d.loginPassword[0];p.password=o,u(o)}}}else console.log("error submit!",g);m.value=!1})}}}}),U={class:"login-page"},L=i("div",{class:"card-header"},[i("span",null,"Login")],-1),M={class:"login-btn-box"},T=i("span",{class:"ml-2"},"Login",-1),j={class:"redirect-info"},O=i("b",null,"Register",-1),S={class:"redirect-info"},W=i("b",null,"Password",-1);function A(e,n,m,v,p,_){const f=t("el-input"),u=t("el-form-item"),b=t("open"),c=t("el-icon"),w=t("el-button"),g=t("el-link"),l=t("el-form"),r=t("el-card"),d=z("loading");return k(),$("div",U,[s(r,null,{header:a(()=>[L]),default:a(()=>[q((k(),B(l,{ref:"ruleFormRef",model:e.ruleForm,rules:e.rules,"label-position":"top"},{default:a(()=>[s(u,{label:"Email",prop:"userName",error:e.errors.userName},{default:a(()=>[s(f,{size:"large",placeholder:"Please Input",modelValue:e.ruleForm.userName,"onUpdate:modelValue":n[0]||(n[0]=o=>e.ruleForm.userName=o)},null,8,["modelValue"])]),_:1},8,["error"]),s(u,{label:"Password",prop:"password",error:e.errors.password},{default:a(()=>[s(f,{"show-password":"",size:"large",placeholder:"Please Input",modelValue:e.ruleForm.password,"onUpdate:modelValue":n[1]||(n[1]=o=>e.ruleForm.password=o)},null,8,["modelValue"])]),_:1},8,["error"]),i("div",M,[s(w,{size:"large",type:"primary",onClick:n[2]||(n[2]=o=>e.login(e.ruleFormRef))},{default:a(()=>[s(c,null,{default:a(()=>[s(b)]),_:1}),T]),_:1})]),i("div",j,[y(" Don't have an account yet? "),s(g,{href:"/register"},{default:a(()=>[O]),_:1})]),i("div",S,[y(" Forgot "),s(g,{href:"/forgot-password"},{default:a(()=>[W]),_:1})])]),_:1},8,["model","rules"])),[[d,e.busy]])]),_:1})])}const H=V(D,[["render",A]]);export{H as default};
