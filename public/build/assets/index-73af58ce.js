import{a as z}from"./app-layout-ddd4ecde.js";import{_ as L}from"./PageTitleBox-3291f9d9.js";import{P as N}from"./Pagination-912d8bd3.js";import{R as S}from"./RemoveEditButton-b2c637d7.js";import{F as q}from"./FormDialog-0d177dd5.js";import{r as F}from"./index-810449cf.js";import{_ as B,r as s,O as P,f as h,h as w,w as p,b as i,i as m,c as E,p as A,F as M,e as l,j as U,t as H,ac as R,Q as j,R as I}from"./app-15300521.js";import{C as Q}from"./CreateButton-a2dd5868.js";import{u as G}from"./useToast-c3bf6ae8.js";const J={components:{FormDialog:q},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0}},setup(g,{emit:o}){let d=s(!1);const e=s(null);let f=s(""),_=s(null),c=s(null),a=s([]);return P(_,y=>{a.value=a.value.filter(t=>t!=y)}),{props:g,form:e,emit:o,save:async()=>{if(!await e.value.validate())return null;try{const{data:t}=await axios.post(route("team.store"),{title:f.value,manager_id:_.value,category_id:c.value,members:a.value});o("push",addProtos(t,{action:!0,showEdit:!1}))}catch(t){console.error(t),validErorrs(t)}},deleteChip:y=>{a.value=a.value.filter(t=>t!==y.id)},busy:d,rs:F,title:f,manager:_,category:c,members:a}}},K={class:"layout gutter--lg"},W={class:"row align-content--center"},X={class:"flex xs12"},Y={class:"flex xs12 mt-2"},Z={class:"flex xs12 mt-2"},D={class:"flex xs12 mt-2"};function $(g,o,d,e,f,_){const c=l("va-input"),a=l("va-select"),u=l("va-chip"),b=l("va-form"),y=l("form-dialog");return h(),w(y,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Create Team",onAdd:e.save,fullscreen:""},{default:p(()=>[i(b,{ref:"form"},{default:p(()=>[m("div",K,[m("div",W,[m("div",X,[i(c,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.title=t),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),m("div",Y,[i(a,{modelValue:e.manager,"onUpdate:modelValue":o[1]||(o[1]=t=>e.manager=t),label:"Team Manager *",placeholder:"Team Manager Here",rules:e.rs("teamManager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),m("div",Z,[i(a,{modelValue:e.category,"onUpdate:modelValue":o[2]||(o[2]=t=>e.category=t),label:"Team Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),m("div",D,[i(a,{modelValue:e.members,"onUpdate:modelValue":o[3]||(o[3]=t=>e.members=t),label:"Team Members *",placeholder:"Team Members Here",rules:e.rs("members",!0),multiple:"",searchable:"","text-by":"name","value-by":"id",options:e.props.employees.filter(t=>t.id!=e.manager)},{content:p(({value:t})=>[(h(!0),E(M,null,A(t,r=>(h(),w(u,{key:r,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":T=>e.deleteChip(r)},{default:p(()=>[U(H(r.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const ee=B(J,[["render",$]]),te={components:{FormDialog:q},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},item:{type:Object,required:!0}},setup(g,{emit:o}){let d=s(g.item),e=s(!1);const f=s(null);let _=s(d.value.title),c=s(d.value.manager_id),a=s(d.value.category_id),u=s(d.value.members.map(t=>t.id));return P(c,t=>{u.value=u.value.filter(r=>r!=t)}),P(g.item,t=>{d.value=t,u.value=t.members.map(r=>r.id),_.value=t.title,c.value=t.manager_id,a.value=t.category_id}),{props:g,form:f,emit:o,save:async()=>{if(!await f.value.validate())return null;try{const{data:r}=await axios.put(route("team.update",{team:d.value.id}),{title:_.value,manager_id:c.value,category_id:a.value,members:u.value});o("replace",addProtos(r,{action:!0,showEdit:!1}))}catch(r){console.error(r),validErorrs(r)}},deleteChip:t=>{u.value=u.value.filter(r=>r!==t.id)},busy:e,rs:F,title:_,manager:c,category:a,members:u}}},oe={class:"layout gutter--lg"},ae={class:"row align-content--center"},le={class:"flex xs12"},se={class:"flex xs12 mt-2"},re={class:"flex xs12 mt-2"},ne={class:"flex xs12 mt-2"};function ie(g,o,d,e,f,_){const c=l("va-input"),a=l("va-select"),u=l("va-chip"),b=l("va-form"),y=l("form-dialog");return h(),w(y,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Edit Team",onAdd:e.save,"is-edit":"",fullscreen:""},{default:p(()=>[i(b,{ref:"form"},{default:p(()=>[m("div",oe,[m("div",ae,[m("div",le,[i(c,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.title=t),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),m("div",se,[i(a,{modelValue:e.manager,"onUpdate:modelValue":o[1]||(o[1]=t=>e.manager=t),label:"Team Manager *",placeholder:"Team Manager Here",rules:e.rs("teamManager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),m("div",re,[i(a,{modelValue:e.category,"onUpdate:modelValue":o[2]||(o[2]=t=>e.category=t),label:"Team Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),m("div",ne,[i(a,{modelValue:e.members,"onUpdate:modelValue":o[3]||(o[3]=t=>e.members=t),label:"Team Members *",placeholder:"Team Members Here",rules:e.rs("members",!0),multiple:"",searchable:"","text-by":"name","value-by":"id",options:e.props.employees.filter(t=>t.id!=e.manager)},{content:p(({value:t})=>[(h(!0),E(M,null,A(t,r=>(h(),w(u,{key:r,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":T=>e.deleteChip(r)},{default:p(()=>[U(H(r.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const me=B(te,[["render",ie]]);const de={components:{AppLayout:z,PageTitleBox:L,Pagination:N,Create:ee,Edit:me,CreateButton:Q,RemoveEditButton:S},setup(){const g=s(!1),o=G(),d=s([]),e=s([]),f=s([]),_=s(!1),c=s([]),a=s(10),u=s("title"),b=[{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"title",sortable:!0},{key:"manager.name",label:"Manager",sortable:!0},{key:"category.title",label:"Category",sortable:!0},{key:"members",label:"Mambers",sortable:!0},{key:"action",thAlign:"right",tdAlign:"right"}],y=s("asc");R("employees",v=>{e.value=v}),R("categories",v=>{f.value=v});const t=async v=>{const x=route("team.index",{perPage:a.value,page:v}),{data:V}=await axios.get(x);c.value=V.links,d.value=addProtos(V.data,{action:!0,showEdit:!1}),g.value=!1};return t(1),{busy:g,showCreate:_,perPage:a,sortingOrder:y,items:d,columns:b,sortBy:u,push:v=>{_.value=!1,d.value.push(v)},replace:(v,x)=>{_.value=!1,d.value.splice(x,1,v)},fetchItems:t,employees:e,categories:f,remove:async(v,x)=>{if(!await j(v,"Team","title"))return null;try{const n=route("team.destroy",{team:v.id});await axios.delete(n),d.value.splice(x,1),I(o)}catch(n){console.log(n)}},links:c}}},ce={class:"row mt-4"},ue={class:"flex md6"},pe={class:"item"},_e={class:"flex lg6"},ve={class:"item right"};function ye(g,o,d,e,f,_){const c=l("create-button"),a=l("page-title-box"),u=l("va-select"),b=l("va-icon"),y=l("va-input"),t=l("va-chip"),r=l("edit"),T=l("remove-edit-button"),O=l("va-data-table"),v=l("pagination"),x=l("create"),V=l("app-layout");return h(),w(V,{busy:e.busy},{default:p(()=>[m("div",null,[i(a,{title:"Teams"},{default:p(()=>[i(c,{title:"Add Team",onClick:o[0]||(o[0]=n=>e.showCreate=!0)})]),_:1})]),m("div",ce,[m("div",ue,[m("div",pe,[i(u,{class:"flex mb-2 md6",label:"Per Page",modelValue:e.perPage,"onUpdate:modelValue":o[1]||(o[1]=n=>e.perPage=n),options:[10,20,30,40,50]},null,8,["modelValue"])])]),m("div",_e,[m("div",ve,[i(y,{class:"flex mb-2 md6",label:"Search"},{prepend:p(()=>[i(b,{class:"material-icons"},{default:p(()=>[U("search")]),_:1})]),_:1})])])]),i(O,{items:e.items,columns:e.columns,hoverable:!0,"sort-by":e.sortBy,"onUpdate:sortBy":o[2]||(o[2]=n=>e.sortBy=n),"sorting-order":e.sortingOrder,"onUpdate:sortingOrder":o[3]||(o[3]=n=>e.sortingOrder=n)},{"cell(members)":p(({rowData:n})=>[(h(!0),E(M,null,A(n.members,C=>(h(),w(t,{size:"small",key:C.id},{default:p(()=>[U(H(C.model.name),1)]),_:2},1024))),128))]),"cell(action)":p(({rowData:n,rowIndex:C})=>[i(T,{onEditClick:k=>n.showEdit=!0,onRemoveClick:k=>e.remove(n,C)},{default:p(()=>[i(r,{show:n.showEdit,"onUpdate:show":k=>n.showEdit=k,item:n,employees:e.employees,categories:e.categories,onReplace:k=>e.replace(k,C)},null,8,["show","onUpdate:show","item","employees","categories","onReplace"])]),_:2},1032,["onEditClick","onRemoveClick"])]),_:1},8,["items","columns","sort-by","sorting-order"]),i(v,{links:e.links,onPage:e.fetchItems},null,8,["links","onPage"]),i(x,{show:e.showCreate,"onUpdate:show":o[4]||(o[4]=n=>e.showCreate=n),employees:e.employees,categories:e.categories,onPush:e.push},null,8,["show","employees","categories","onPush"])]),_:1},8,["busy"])}const Te=B(de,[["render",ye],["__scopeId","data-v-19e46dee"]]);export{Te as default};
