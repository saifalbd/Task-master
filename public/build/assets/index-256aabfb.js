import{a as N}from"./app-layout-64dac59a.js";import{_ as U}from"./PageTitleBox-8fee726d.js";import{C as q}from"./CreateButton-7cd52cfe.js";import{F as R}from"./FormDialog-027f7880.js";import{h as D}from"./moment-fbc5633a.js";import{_ as M,r as f,a as F,f as h,h as V,w as r,b as l,c as A,x as T,F as E,i,e as n,t as L,l as B,g as P,z as C,j as Y,k as j,A as k}from"./app-5a52a3e4.js";const z={components:{FormDialog:R},props:{show:{type:Boolean,default:!1},categories:{type:Array,required:!0}},setup(v,{emit:o}){const b=f(!1),e=f(),c=F({title:"",category:"",date:new Date,time:new Date}),y=F({title:[{required:!0,message:"Title Are Required",trigger:"change"}],category:[{required:!0,message:"Category Are Required",trigger:"change"}]});return{props:v,busy:b,save:async d=>{d&&await d.validate(async(p,w)=>{if(!p)return null;try{b.value=!0;const g=route("event.store"),{data:a}=await axios.post(g,{title:c.title,category:c.category,date:D(c.date).format("YYYY-MM-DD"),time:D(c.time).format("h:mm:ss")});title.value="",b.value=!1}catch(g){console.error(g)}})},form:c,emit:o,rules:y,ruleFormRef:e}}},I=i("span",{class:"text-gray-500"},"-",-1);function S(v,o,b,e,c,y){const _=n("el-input"),d=n("el-form-item"),p=n("el-option"),w=n("el-select"),g=n("el-date-picker"),a=n("el-col"),u=n("el-time-picker"),m=n("el-form"),s=n("form-dialog");return h(),V(s,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Create Event",onAdd:o[5]||(o[5]=t=>e.save(e.ruleFormRef))},{default:r(()=>[l(m,{model:e.form,rules:e.rules,ref:"ruleFormRef","label-width":"120px"},{default:r(()=>[l(d,{label:"Title",prop:"title"},{default:r(()=>[l(_,{modelValue:e.form.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.form.title=t)},null,8,["modelValue"])]),_:1}),l(d,{label:"Category",prop:"category","label-width":"120px"},{default:r(()=>[l(w,{modelValue:e.form.category,"onUpdate:modelValue":o[1]||(o[1]=t=>e.form.category=t),placeholder:"please select your Category"},{default:r(()=>[(h(!0),A(E,null,T(e.props.categories,(t,x)=>(h(),V(p,{key:x,label:t.title,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"Activity time"},{default:r(()=>[l(a,{span:11},{default:r(()=>[l(g,{modelValue:e.form.date,"onUpdate:modelValue":o[2]||(o[2]=t=>e.form.date=t),type:"date",placeholder:"Pick a date",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(a,{span:2,class:"text-center"},{default:r(()=>[I]),_:1}),l(a,{span:11},{default:r(()=>[l(u,{modelValue:e.form.time,"onUpdate:modelValue":o[3]||(o[3]=t=>e.form.time=t),placeholder:"Pick a time",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show","busy"])}const G=M(z,[["render",S]]);const H={components:{AppLayout:N,PageTitleBox:U,CreateButton:q,CreateVue:G},setup(){const v=f(),o=f(!0),b=f(!1),e=f([]),c=f({}),y=f(null),_=f(null);let d=D();y.value=d.month(),_.value=d.year();const p=a=>{let u=c.value[a];return u?(console.log(u),u):[]};return L("eventCategories",a=>{e.value=a}),(async()=>{try{let a=new Date(`${_.value}-${y.value+1}-01`),u=D(a).format("YYYY-MM");const m=route("event.index",{dateLike:u}),{data:s}=await axios.get(m);let t=B.groupBy(B.sortBy(s,"categoryName").map(x=>(x.sortTitle=B.truncate(x.title,{length:10,separator:".."}),x)),"date");c.value=t,console.log(t),o.value=!1}catch(a){console.error(a)}})(),{busy:o,calendar:v,showCreate:b,events:c,eventCategories:e,selectDate:a=>{v.value.selectDate(a);const u=v.value.selectedDay;if(a=="today"){let m=new Date;y.value=m.getMonth(),_.value=m.getFullYear()}else{const{$M:m,$y:s}=u;y.value=m,_.value=s}},getEvents:p}}},J={class:"calendar-box"},K={class:"date-box"},O={class:"top-bar"},Q={class:"info-box"},W=["title"];function X(v,o,b,e,c,y){const _=n("create-button"),d=n("page-title-box"),p=n("el-button"),w=n("el-button-group"),g=n("el-calendar"),a=n("create-vue"),u=n("app-layout"),m=j("loading");return h(),V(u,{busy:!1},{default:r(()=>[i("div",null,[l(d,{title:"Events"},{default:r(()=>[l(_,{title:"Add Events",onClick:o[0]||(o[0]=s=>e.showCreate=!0)})]),_:1})]),i("div",J,[P((h(),V(g,{ref:"calendar"},{header:r(({date:s})=>[i("span",null,C(s),1),l(w,null,{default:r(()=>[l(p,{onClick:o[1]||(o[1]=t=>e.selectDate("prev-month"))},{default:r(()=>[Y(" Previous Month ")]),_:1}),l(p,{onClick:o[2]||(o[2]=t=>e.selectDate("today"))},{default:r(()=>[Y("Today")]),_:1}),l(p,{onClick:o[3]||(o[3]=t=>e.selectDate("next-month"))},{default:r(()=>[Y(" Next Month ")]),_:1})]),_:1})]),"date-cell":r(({data:s})=>[i("div",K,[i("div",O,[i("div",null,C(s.day.split("-").slice(2).join("-")),1)]),i("div",Q,[i("ul",null,[(h(!0),A(E,null,T(e.getEvents(s.day),t=>(h(),A("li",{key:t.id,title:t.title,style:k({borderColor:t.color.border,backgroundColor:t.color.bg})},[i("span",{class:"time",style:k({color:t.color.time})},C(t.time)+":",5),i("span",{class:"cat",style:k({color:t.color.cat})},C(t.categoryName)+":",5),i("span",{style:k({color:t.color.title})},C(t.sortTitle),5)],12,W))),128))])])])]),_:1})),[[m,e.busy]])]),l(a,{show:e.showCreate,"onUpdate:show":o[4]||(o[4]=s=>e.showCreate=s),categories:e.eventCategories},null,8,["show","categories"])]),_:1})}const ae=M(H,[["render",X],["__scopeId","data-v-e985d801"]]);export{ae as default};
