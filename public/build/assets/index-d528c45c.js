import{a as N,S as Q}from"./app-layout-62a20c1a.js";import{_ as I}from"./PageTitleBox-34f8655b.js";import{P as Z}from"./Pagination-0fa3f7a5.js";import{R as G}from"./RemoveEditButton-6c02efb2.js";import{_ as L,r as a,Z as A,f as y,h as C,w as f,b as n,i as s,c as U,x as E,F as B,g as D,am as F,B as M,e as i,j as H,z as q,t as S,u as J,a2 as K,a3 as W}from"./app-fc468544.js";import{F as R}from"./FormDialog-3370bb78.js";import{r as z}from"./index-dc654618.js";import{h as O}from"./moment-fbc5633a.js";import{C as X}from"./CreateButton-8d1e5d7b.js";import{u as Y}from"./useToast-70ffcdc4.js";const $={components:{FormDialog:R},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},teams:{type:Array,required:!0}},setup(w,{emit:o}){let k=a(!1);const e=a(null);let T=a(""),P=a(null),p=a(null),m=a([]),v=a(null),b=a(null);const x=a(O().format(dateFormat)),h=a(null),V=a(""),g=a([]);let t=a(!1);return A(m,_=>{_.map(r=>r.value).includes(v)||(v.value=null)}),A(t,_=>{_?m.value=[]:b.value=null}),{props:w,form:e,emit:o,save:async()=>{let _=route("project.store");if(!await e.value.validate())return console.error("validation errors"),null;k.value=!0;const d={title:T.value,manager:P.value,category:p.value,members:m.value.map(c=>c.id),team:b.value,team_manager:v.value,byTeam:t.value?1:0,start:x.value,end:h.value,attachments:g.value,description:V.value},l=new FormData;l.append("title",d.title),l.append("manager",d.manager),l.append("category",d.category),d.team&&l.append("team",d.team),l.append("team_manager",d.team_manager),l.append("byTeam",d.byTeam),l.append("start",d.start),l.append("end",d.end),l.append("description",d.description),d.members.forEach((c,j)=>{l.append(`members[${j}]`,c)}),d.attachments.forEach((c,j)=>{l.append(`attachments[${j}]`,c)});try{const{data:c}=await axios.post(_,l);o("push",addProtos(c,{action:!0,showEdit:!1}))}catch(c){console.error(c),validErorrs(c)}k.value=!1},rs:z,busy:k,byTeam:t,team_manager:v,team:b,title:T,start:x,end:h,manager:P,category:p,members:m,description:V,attachments:g}}},ee={class:"layout gutter--md"},te={class:"row align-content--center"},oe={class:"flex xs12 in-box"},le={class:"flex xs12 in-box"},ae={class:"flex xs12 in-box"},ne={class:"flex xs12"},re=s("h1",null,"Project Assignment By:-",-1),se={class:"flex xs12 in-box"},ie={class:"flex xs12 in-box"},de={key:0,class:"flex xs12 mb-2"},me=s("h1",null,"Project Leader:-",-1),ue={class:"flex xs6 in-box"},ce={class:"flex xs6 in-box"},pe={class:"flex xs12 in-box"},ve={class:"flex xs12",style:{"min-height":"150px","margin-bottom":"50px"}};function _e(w,o,k,e,T,P){const p=i("va-input"),m=i("va-select"),v=i("va-radio"),b=i("va-chip"),x=i("va-file-upload"),h=i("QuillEditor"),V=i("va-form"),g=i("form-dialog");return y(),C(g,{show:e.props.show,"onUpdate:show":o[11]||(o[11]=t=>e.emit("update:show",t)),busy:e.busy,title:"Create Project",onAdd:e.save,fullscreen:!0},{default:f(()=>[n(V,{ref:"form"},{default:f(()=>[s("div",ee,[s("div",te,[s("div",oe,[n(p,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.title=t),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),s("div",le,[n(m,{modelValue:e.manager,"onUpdate:modelValue":o[1]||(o[1]=t=>e.manager=t),label:"Project Manager *",placeholder:"Project Manager Here",rules:e.rs("manager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),s("div",ae,[n(m,{modelValue:e.category,"onUpdate:modelValue":o[2]||(o[2]=t=>e.category=t),label:"Project Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),s("div",ne,[re,(y(),U(B,null,E([{text:"ByTeam",value:!0},{text:"By Members",value:!1}],(t,u)=>n(v,{key:u,modelValue:e.byTeam,"onUpdate:modelValue":o[3]||(o[3]=_=>e.byTeam=_),label:t.text,option:t.value},null,8,["modelValue","label","option"])),64))]),D(s("div",se,[n(m,{modelValue:e.team,"onUpdate:modelValue":o[4]||(o[4]=t=>e.team=t),label:"Project Team*",placeholder:"Project Team Here","text-by":"title","value-by":"id",options:e.props.teams,rules:e.rs("team",{required:e.byTeam})},null,8,["modelValue","options","rules"])],512),[[F,e.byTeam]]),D(s("div",ie,[n(m,{modelValue:e.members,"onUpdate:modelValue":o[5]||(o[5]=t=>e.members=t),label:"Project Employees *",placeholder:"Project Employee Here",rules:e.rs("members",{required:!e.byTeam}),multiple:"",searchable:"","text-by":"name",options:e.props.employees.filter(t=>t.id!=e.manager)},{content:f(({value:t})=>[(y(!0),U(B,null,E(t,u=>(y(),C(b,{key:u,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":_=>w.deleteChip(u)},{default:f(()=>[H(q(u.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])],512),[[F,!e.byTeam]]),!e.byTeam&&e.members.length>1?(y(),U("div",de,[me,(y(!0),U(B,null,E(e.members,(t,u)=>(y(),C(v,{key:u,modelValue:e.team_manager,"onUpdate:modelValue":o[6]||(o[6]=_=>e.team_manager=_),label:t.name,option:t.id},null,8,["modelValue","label","option"]))),128))])):M("",!0),s("div",ue,[n(p,{modelValue:e.start,"onUpdate:modelValue":o[7]||(o[7]=t=>e.start=t),label:"Start *",type:"date",placeholder:"Start Here",rules:e.rs("start",!0)},null,8,["modelValue","rules"])]),s("div",ce,[n(p,{modelValue:e.end,"onUpdate:modelValue":o[8]||(o[8]=t=>e.end=t),type:"date",label:"Dead Line *",placeholder:"Dead Line Here",rules:e.rs("dead line",!0)},null,8,["modelValue","rules"])]),s("div",pe,[n(x,{modelValue:e.attachments,"onUpdate:modelValue":o[9]||(o[9]=t=>e.attachments=t),dropzone:""},null,8,["modelValue"])]),s("div",ve,[n(h,{theme:"snow",toolbar:"minimal",contentType:"html",content:e.description,"onUpdate:content":o[10]||(o[10]=t=>e.description=t),placeholder:"Description Html Contant"},null,8,["content"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const ye=L($,[["render",_e]]),be={components:{FormDialog:R},props:{show:{type:Boolean,default:!1},employees:{type:Array,required:!0},categories:{type:Array,required:!0},teams:{type:Array,required:!0},item:{type:Object,required:!0}},setup(w,{emit:o}){let k=a(w.item),e=a(!1);const T=a(null);let P=a(""),p=a(null),m=a(null),v=a([]),b=a(null),x=a(null);const h=a(O().format(dateFormat)),V=a(null),g=a(""),t=a([]);let u=a(!0);return A(v,r=>{r.map(d=>d.value).includes(b)||(b.value=null)}),A(w.item,r=>{P.value=r.title,p.value=r.manager_id,m.value=r.category_id,x.value=r.team_id,h.value=r.start,V.value=r.end,g.value=r.description,k.value=r},{immediate:!0}),{props:w,form:T,emit:o,save:async()=>{let r=route("project.update",{project:k.value.id});if(!await T.value.validate())return null;try{const{data:l}=await axios.put(r,{title:P.value,manager:p.value,category:m.value,members:v.value.map(c=>c.id),team:x.value,team_manager:b.value,byTeam:u.value?1:0,start:h.value,end:V.value,attachments:t.value,description:g.value});o("replace",addProtos(l,{action:!0,showEdit:!1}))}catch(l){console.error(l),validErorrs(l)}},rs:z,busy:e,byTeam:u,team_manager:b,team:x,title:P,start:h,end:V,manager:p,category:m,members:v,description:g,attachments:t}}},fe={class:"layout gutter--md"},ge={class:"row align-content--center"},xe={class:"flex xs12 in-box"},he={class:"flex xs12 in-box"},Ve={class:"flex xs12 in-box"},we={class:"flex xs12"},Pe=s("h1",null,"Project Assignment By:-",-1),ke={key:0,class:"flex xs12 in-box"},Te={key:1,class:"flex xs12 in-box"},Ue={key:2,class:"flex xs12 mb-2"},je=s("h1",null,"Project Leader:-",-1),Ce={class:"flex xs6 in-box"},Ee={class:"flex xs6 in-box"},Be={class:"flex xs12 in-box"},Ae={class:"flex xs12",style:{"min-height":"150px","margin-bottom":"50px"}};function He(w,o,k,e,T,P){const p=i("va-input"),m=i("va-select"),v=i("va-radio"),b=i("va-chip"),x=i("va-file-upload"),h=i("QuillEditor"),V=i("va-form"),g=i("form-dialog");return y(),C(g,{show:e.props.show,"onUpdate:show":o[11]||(o[11]=t=>e.emit("update:show",t)),busy:e.busy,title:"Edit Project",onAdd:e.save,"is-edit":"",fullscreen:!0},{default:f(()=>[n(V,{ref:"form"},{default:f(()=>[s("div",fe,[s("div",ge,[s("div",xe,[n(p,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.title=t),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),s("div",he,[n(m,{modelValue:e.manager,"onUpdate:modelValue":o[1]||(o[1]=t=>e.manager=t),label:"Project Manager *",placeholder:"Project Manager Here",rules:e.rs("manager",!0),"text-by":"name","value-by":"id",options:e.props.employees},null,8,["modelValue","rules","options"])]),s("div",Ve,[n(m,{modelValue:e.category,"onUpdate:modelValue":o[2]||(o[2]=t=>e.category=t),label:"Project Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),s("div",we,[Pe,(y(),U(B,null,E([{text:"ByTeam",value:!0},{text:"By Members",value:!1}],(t,u)=>n(v,{key:u,modelValue:e.byTeam,"onUpdate:modelValue":o[3]||(o[3]=_=>e.byTeam=_),label:t.text,option:t.value},null,8,["modelValue","label","option"])),64))]),e.byTeam?(y(),U("div",ke,[n(m,{modelValue:e.team,"onUpdate:modelValue":o[4]||(o[4]=t=>e.team=t),label:"Project Team*",placeholder:"Project Team Here",rules:e.rs("team",e.byTeam),"text-by":"title","value-by":"id",options:e.props.teams},null,8,["modelValue","rules","options"])])):(y(),U("div",Te,[n(m,{modelValue:e.members,"onUpdate:modelValue":o[5]||(o[5]=t=>e.members=t),label:"Project Employees *",placeholder:"Project Employee Here",rules:e.rs("members",!e.byTeam),multiple:"",searchable:"","text-by":"name",options:e.props.employees.filter(t=>t.id!=e.manager)},{content:f(({value:t})=>[(y(!0),U(B,null,E(t,u=>(y(),C(b,{key:u,size:"small",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":_=>w.deleteChip(u)},{default:f(()=>[H(q(u.name),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),_:1},8,["modelValue","rules","options"])])),!e.byTeam&&e.members.length>1?(y(),U("div",Ue,[je,(y(!0),U(B,null,E(e.members,(t,u)=>(y(),C(v,{key:u,modelValue:e.team_manager,"onUpdate:modelValue":o[6]||(o[6]=_=>e.team_manager=_),label:t.name,option:t.id},null,8,["modelValue","label","option"]))),128))])):M("",!0),s("div",Ce,[n(p,{modelValue:e.start,"onUpdate:modelValue":o[7]||(o[7]=t=>e.start=t),label:"Start *",type:"date",placeholder:"Start Here",rules:e.rs("start",!0)},null,8,["modelValue","rules"])]),s("div",Ee,[n(p,{modelValue:e.end,"onUpdate:modelValue":o[8]||(o[8]=t=>e.end=t),type:"date",label:"Dead Line *",placeholder:"Dead Line Here",rules:e.rs("dead line",!0)},null,8,["modelValue","rules"])]),s("div",Be,[n(x,{modelValue:e.attachments,"onUpdate:modelValue":o[9]||(o[9]=t=>e.attachments=t),dropzone:""},null,8,["modelValue"])]),s("div",Ae,[n(h,{theme:"snow",toolbar:"minimal",contentType:"html",content:e.description,"onUpdate:content":o[10]||(o[10]=t=>e.description=t),placeholder:"Description Html Contant"},null,8,["content"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const Se=L(be,[["render",He]]);const Le={components:{AppLayout:N,PageTitleBox:I,Pagination:Z,Create:ye,Edit:Se,CreateButton:X,RemoveEditButton:G,StatusBtn:Q},setup(){const w=a(!0),o=Y(),k=J(),e=a([]),T=a([]),P=a([]),p=a([]),m=a(!1),v=a([]),b=a(10),x=a("title"),h=[{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"title",sortable:!0},{key:"manager.name",label:"Manager",sortable:!0},{key:"category.title",label:"Category",sortable:!0},{key:"start",label:"Start",sortable:!0},{key:"end",label:"Dead Line",sortable:!0},{key:"team.title",label:"Team",sortable:!0},{key:"status",sortable:!0},{key:"action",thAlign:"right",tdAlign:"right"}],V=a("asc");S("employees",r=>{T.value=r}),S("categories",r=>{P.value=r}),S("teams",r=>{p.value=r});const g=async r=>{try{const d=route("project.index",{perPage:b.value,page:r}),{data:l}=await axios.get(d);v.value=l.links,e.value=addProtos(l.data,{action:!0,showEdit:!1})}catch(d){console.error(d)}w.value=!1};return g(1),{router:k,showCreate:m,perPage:b,sortingOrder:V,items:e,columns:h,sortBy:x,push:r=>{m.value=!1,e.value.push(r)},replace:(r,d)=>{m.value=!1,e.value.splice(d,1,r)},fetchItems:g,employees:T,categories:P,teams:p,remove:async(r,d)=>{if(!await K(r,"Project","title"))return null;try{const c=route("project.destroy",{project:r.id});await axios.delete(c),e.value.splice(d,1),W(o)}catch(c){console.log(c)}},links:v,busy:w}}},qe={class:"row mt-4"},De={class:"flex md6"},Fe={class:"item"},Me={class:"flex lg6"},Re={class:"item right"};function ze(w,o,k,e,T,P){const p=i("create-button"),m=i("page-title-box"),v=i("va-select"),b=i("va-icon"),x=i("va-input"),h=i("va-chip"),V=i("status-btn"),g=i("edit"),t=i("remove-edit-button"),u=i("va-data-table"),_=i("pagination"),r=i("create"),d=i("app-layout");return y(),C(d,{busy:e.busy},{default:f(()=>[s("div",null,[n(m,{title:"Projects"},{default:f(()=>[n(p,{title:"Add Project",onClick:o[0]||(o[0]=l=>e.showCreate=!0)})]),_:1})]),s("div",qe,[s("div",De,[s("div",Fe,[n(v,{class:"flex mb-2 md6",label:"Per Page",modelValue:e.perPage,"onUpdate:modelValue":o[1]||(o[1]=l=>e.perPage=l),options:[10,20,30,40,50]},null,8,["modelValue"])])]),s("div",Me,[s("div",Re,[n(x,{class:"flex mb-2 md6",label:"Search"},{prepend:f(()=>[n(b,{class:"material-icons"},{default:f(()=>[H("search")]),_:1})]),_:1})])])]),n(u,{items:e.items,columns:e.columns,hoverable:!0,"sort-by":e.sortBy,"onUpdate:sortBy":o[2]||(o[2]=l=>e.sortBy=l),"sorting-order":e.sortingOrder,"onUpdate:sortingOrder":o[3]||(o[3]=l=>e.sortingOrder=l)},{"cell(members)":f(({rowData:l})=>[(y(!0),U(B,null,E(l.members,c=>(y(),C(h,{size:"small",key:c.id},{default:f(()=>[H(q(c.name),1)]),_:2},1024))),128))]),"cell(status)":f(({value:l})=>[n(V,{status:l},null,8,["status"])]),"cell(action)":f(({rowData:l,rowIndex:c})=>[n(t,{isView:!0,onViewClick:j=>e.router.push({name:"project.show",params:{id:l.id}}),onEditClick:j=>l.showEdit=!0,onRemoveClick:j=>e.remove(l,c)},{default:f(()=>[n(g,{show:l.showEdit,"onUpdate:show":j=>l.showEdit=j,item:l,employees:e.employees,categories:e.categories,teams:e.teams,onReplace:j=>e.replace(j,c)},null,8,["show","onUpdate:show","item","employees","categories","teams","onReplace"])]),_:2},1032,["onViewClick","onEditClick","onRemoveClick"])]),_:1},8,["items","columns","sort-by","sorting-order"]),n(_,{links:e.links,onPage:e.fetchItems},null,8,["links","onPage"]),n(r,{show:e.showCreate,"onUpdate:show":o[4]||(o[4]=l=>e.showCreate=l),employees:e.employees,categories:e.categories,teams:e.teams,onPush:e.push},null,8,["show","employees","categories","teams","onPush"])]),_:1},8,["busy"])}const Ye=L(Le,[["render",ze],["__scopeId","data-v-152f942a"]]);export{Ye as default};
