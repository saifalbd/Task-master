import{A as Z,P as F}from"./PageTitleBox-ebdb7c37.js";import{P as T}from"./Pagination-d3273910.js";import{F as B,r as N,u as j}from"./index-d538a892.js";import{_ as A,r as n,A as C,B as q,o as P,h as k,i as E,k as r,a as d,c as z,l as H,F as O,C as R,j as s,D as I,E as L,e as S}from"./app-ec84c5d3.js";import{C as G}from"./CreateButton-d297d6f1.js";import{R as J}from"./RemoveEditButton-5e934d45.js";const K={components:{FormDialog:B},props:{positions:{type:Array,required:!0},show:{type:Boolean,default:!1}},setup(c,{emit:o}){var w;let f=n(!1);const e=n(null),h=n(null);let _=n(""),i=n(""),v=n(""),u=n((w=C.head(c.positions))==null?void 0:w.id);q(c.positions,p=>{var l;p.length&&(u.value=(l=C.head(p))==null?void 0:l.id)});let y={title:[p=>!!p||"title are requies"]};const t=async()=>{let p=route("employee.store");if(!await h.value.validate())return null;try{const{data:m}=await axios.post(p,{name:_.value,email:i.value,phone:v.value,position:u.value});o("push",addProtos(m,{action:!0,showEdit:!1}))}catch(m){console.error(m),R(m)}};return{props:c,form:h,emit:o,changeEmail:async p=>{const{value:l}=p.target;if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(l))return null;try{const a=route("user.showByEmail",{email:l}),{data:V}=await axios.get(a),b=C.values(V)?V:null;e.value=b,b&&(_.value=b.name)}catch(a){console.log(a)}},rs:N,save:t,busy:f,rules:y,save:t,name:_,phone:v,email:i,position:u}}},M={class:"layout gutter--md"},Q={class:"row align-content--center"},W={class:"flex xs12"},X={class:"flex xs12 mt-2"},Y={class:"flex xs12 mt-2"},D={class:"flex xs12 mt-2"};function $(c,o,f,e,h,_){const i=s("va-input"),v=s("va-radio"),u=s("va-form"),y=s("form-dialog");return P(),k(y,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Create User",onAdd:e.save,fullscreen:""},{default:E(()=>[r(u,{ref:"form"},{default:E(()=>[d("div",M,[d("div",Q,[d("div",W,[r(i,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.name=t),label:"Name *",placeholder:"Name Here",rules:e.rs("Name",!0)},null,8,["modelValue","rules"])]),d("div",X,[r(i,{modelValue:e.email,"onUpdate:modelValue":o[1]||(o[1]=t=>e.email=t),label:"Email *",placeholder:"Email Here",onChange:e.changeEmail,rules:e.rs("Email",{required:!0,email:!0})},null,8,["modelValue","onChange","rules"])]),d("div",Y,[r(i,{modelValue:e.phone,"onUpdate:modelValue":o[2]||(o[2]=t=>e.phone=t),label:"Phone",placeholder:"Phone Here"},null,8,["modelValue"])]),d("div",D,[(P(!0),z(O,null,H(e.props.positions,(t,x)=>(P(),k(v,{key:x,modelValue:e.position,"onUpdate:modelValue":o[3]||(o[3]=w=>e.position=w),label:t.title,option:t.id},null,8,["modelValue","label","option"]))),128))])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const ee=A(K,[["render",$]]),oe={components:{FormDialog:B},props:{positions:{type:Array,required:!0},show:{type:Boolean,default:!1},item:{type:Object,required:!0}},setup(c,{emit:o}){var p;let f=n(!1);const e=n(null),h=n(null);let _=n(c.item.name),i=n(c.item.email),v=n(""),u=n(c.item);q(c.item,l=>{u.value=l});let y=n((p=c.item.position)==null?void 0:p.id),t={title:[l=>!!l||"title are requies"]};const x=async()=>{let l=route("employee.update",{employee:u.value.id});if(!await h.value.validate())return null;try{const{data:g}=await axios.put(l,{name:_.value,email:i.value,phone:v.value,position:y.value});o("replace",addProtos(g,{action:!0,showEdit:!1}))}catch(g){console.error(g),R(g)}};return{props:c,form:h,emit:o,changeEmail:async l=>{const{value:m}=l.target;if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(m))return null;try{const V=route("user.showByEmail",{email:m}),{data:b}=await axios.get(V),U=C.values(b)?b:null;e.value=U,U&&(_.value=U.name)}catch(V){console.log(V)}},rs:N,save:x,busy:f,rules:t,save:x,name:_,phone:v,email:i,position:y}}},te={class:"layout gutter--md"},le={class:"row align-content--center"},ae={class:"flex xs12"},ne={class:"flex xs12 mt-2"},se={class:"flex xs12 mt-2"},ie={class:"flex xs12 mt-2"};function re(c,o,f,e,h,_){const i=s("va-input"),v=s("va-radio"),u=s("va-form"),y=s("form-dialog");return P(),k(y,{show:e.props.show,"onUpdate:show":o[4]||(o[4]=t=>e.emit("update:show",t)),busy:e.busy,title:"Edit User","is-edit":"",onAdd:e.save},{default:E(()=>[r(u,{ref:"form"},{default:E(()=>[d("div",te,[d("div",le,[d("div",ae,[r(i,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.name=t),label:"Name *",placeholder:"Name Here",rules:e.rs("Name",!0)},null,8,["modelValue","rules"])]),d("div",ne,[r(i,{modelValue:e.email,"onUpdate:modelValue":o[1]||(o[1]=t=>e.email=t),label:"Email *",placeholder:"Email Here",onChange:e.changeEmail,rules:e.rs("Email",{required:!0,email:!0})},null,8,["modelValue","onChange","rules"])]),d("div",se,[r(i,{modelValue:e.phone,"onUpdate:modelValue":o[2]||(o[2]=t=>e.phone=t),label:"Phone",placeholder:"Phone Here"},null,8,["modelValue"])]),d("div",ie,[(P(!0),z(O,null,H(e.props.positions,(t,x)=>(P(),k(v,{key:x,modelValue:e.position,"onUpdate:modelValue":o[3]||(o[3]=w=>e.position=w),label:t.title,option:t.id},null,8,["modelValue","label","option"]))),128))])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const de=A(oe,[["render",re]]);const me={components:{AppLayout:Z,PageTitleBox:F,Pagination:T,Create:ee,CreateButton:G,Edit:de,RemoveEditButton:J},setup(){const c=n(!0),o=j(),f=n([]),e=n([]),h=n(!1),_=n([]),i=n(10),v=n("name"),u=[{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"name",sortable:!0},{key:"email",sortable:!0},{key:"position.title",label:"Position",sortable:!0},{key:"action",thAlign:"right"}],y=n("asc"),t=async l=>{const m=route("employee.index",{perPage:i.value,page:l}),{data:g}=await axios.get(m);_.value=g.links,f.value=addProtos(g.data,{action:!0,showEdit:!1}),c.value=!1};t(1);const x=(l,m)=>{h.value=!1,f.value.splice(m,1,l)},w=l=>{h.value=!1,f.value.push(l)};return axios.get(route("positions")).then(({data:l})=>e.value=l),{busy:c,showCreate:h,perPage:i,sortingOrder:y,items:f,positions:e,columns:u,sortBy:v,remove:async(l,m)=>{if(!await I(l,"Employee","email"))return null;try{const a=route("employee.destroy",{employee:l.id});await axios.delete(a),f.value.splice(m,1),L(o)}catch(a){console.log(a)}},push:w,replace:x,fetchItems:t,links:_}}},ce={class:"row mt-4"},ue={class:"flex md6"},pe={class:"item"},_e={class:"flex lg6"},ve={class:"item right"};function fe(c,o,f,e,h,_){const i=s("create-button"),v=s("page-title-box"),u=s("va-select"),y=s("va-icon"),t=s("va-input"),x=s("edit"),w=s("remove-edit-button"),p=s("va-data-table"),l=s("pagination"),m=s("create"),g=s("app-layout");return P(),k(g,{busy:e.busy},{default:E(()=>[d("div",null,[r(v,{title:"Employees"},{default:E(()=>[r(i,{title:"Add Employee",onClick:o[0]||(o[0]=a=>e.showCreate=!0)})]),_:1})]),d("div",ce,[d("div",ue,[d("div",pe,[r(u,{class:"flex mb-2 md6",label:"Per Page",modelValue:e.perPage,"onUpdate:modelValue":o[1]||(o[1]=a=>e.perPage=a),options:[10,20,30,40,50]},null,8,["modelValue"])])]),d("div",_e,[d("div",ve,[r(t,{class:"flex mb-2 md6",label:"Search"},{prepend:E(()=>[r(y,{class:"material-icons"},{default:E(()=>[S("search")]),_:1})]),_:1})])])]),r(p,{items:e.items,columns:e.columns,hoverable:!0,"sort-by":e.sortBy,"onUpdate:sortBy":o[2]||(o[2]=a=>e.sortBy=a),"sorting-order":e.sortingOrder,"onUpdate:sortingOrder":o[3]||(o[3]=a=>e.sortingOrder=a)},{"cell(action)":E(({rowData:a,rowIndex:V})=>[r(w,{onEditClick:b=>a.showEdit=!0,onRemoveClick:b=>e.remove(a,V)},{default:E(()=>[r(x,{show:a.showEdit,"onUpdate:show":b=>a.showEdit=b,positions:e.positions,item:a,onReplace:b=>e.replace(b,V)},null,8,["show","onUpdate:show","positions","item","onReplace"])]),_:2},1032,["onEditClick","onRemoveClick"])]),_:1},8,["items","columns","sort-by","sorting-order"]),r(l,{links:e.links,onPage:e.fetchItems},null,8,["links","onPage"]),r(m,{show:e.showCreate,"onUpdate:show":o[4]||(o[4]=a=>e.showCreate=a),positions:e.positions,onPush:e.push},null,8,["show","positions","onPush"])]),_:1},8,["busy"])}const Ee=A(me,[["render",fe],["__scopeId","data-v-6285aa05"]]);export{Ee as default};
