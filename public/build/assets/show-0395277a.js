import{A,P as E}from"./PageTitleBox-2a1a7b4e.js";import{_ as j,n as i,o as k,f as C,g as f,i as n,a as t,h as r,d as U,b as w,p as B,k as D,c as g,F as L,j as P,t as y,m as q,q as H}from"./app-9ac6d560.js";import{S as M}from"./index-d896884f.js";import{S}from"./statusBtn-cc0fa534.js";import{C as N}from"./CreateButton-f5bc6037.js";import{F,r as I}from"./index-8a8b9b11.js";import{h as z}from"./moment-fbc5633a.js";import{R}from"./RemoveEditButton-d3495427.js";import"./icon-c404ea0d.js";import"./index-d8cf651c.js";const Q={components:{FormDialog:F},props:{show:{type:Boolean,default:!1},project_id:{type:Number,required:!0},members:{type:Array,required:!0},categories:{type:Array,required:!0}},setup(a,{emit:o}){let b=i(!1);const e=i(null);let _=i(""),v=i(null),c=i([]);const u=i(z().format(dateFormat)),p=i(null),l=i(""),h=i([]);return{props:a,form:e,emit:o,save:async()=>{let s=route("project.task.store",{project:a.project_id});await e.value.validate();try{const d=new FormData;d.append("title",_.value),d.append("category",v.value),c.value.forEach((V,T)=>{d.append(`employees[${T}]`,V.id)}),d.append("start",u.value),d.append("end",p.value),d.append("description",l.value),h.value.forEach((V,T)=>{d.append(`attachments[${T}]`,V)});const{data:x}=await axios.post(s,d);o("push",addProtos(x,{showModel:!1,showEdit:!1}))}catch(d){console.error(d),validErorrs(d)}},rs:I,busy:b,title:_,start:u,end:p,employees:c,category:v,description:l,attachments:h}}},O={class:"layout gutter--md"},G={class:"row align-content--center"},J={class:"flex xs12 in-box"},K={class:"flex xs12 in-box"},W={class:"flex xs12 in-box"},X={class:"flex xs6 in-box"},Y={class:"flex xs6 in-box"},Z={class:"flex xs12 in-box"},$={class:"flex xs12",style:{"min-height":"150px","margin-bottom":"50px"}};function ee(a,o,b,e,_,v){const c=r("va-input"),u=r("va-select"),p=r("va-file-upload"),l=r("QuillEditor"),h=r("va-form"),m=r("form-dialog");return k(),C(m,{show:e.props.show,"onUpdate:show":o[7]||(o[7]=s=>e.emit("update:show",s)),busy:e.busy,title:"Create Task",onAdd:e.save,fullscreen:!0},{default:f(()=>[n(h,{ref:"form"},{default:f(()=>[t("div",O,[t("div",G,[t("div",J,[n(c,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=s=>e.title=s),label:"Title *",placeholder:"Title Here",rules:e.rs("title",!0)},null,8,["modelValue","rules"])]),t("div",K,[n(u,{modelValue:e.category,"onUpdate:modelValue":o[1]||(o[1]=s=>e.category=s),label:"Project Category *",placeholder:"Category Here",rules:e.rs("Category",!0),"text-by":"title","value-by":"id",options:e.props.categories},null,8,["modelValue","rules","options"])]),t("div",W,[n(u,{modelValue:e.employees,"onUpdate:modelValue":o[2]||(o[2]=s=>e.employees=s),label:"Task Employee *",placeholder:"Task Employee Here",rules:e.rs("member",!0),searchable:"",multiple:"","text-by":"name",options:e.props.members},null,8,["modelValue","rules","options"])]),t("div",X,[n(c,{modelValue:e.start,"onUpdate:modelValue":o[3]||(o[3]=s=>e.start=s),label:"Start *",type:"date",placeholder:"Start Here",rules:e.rs("start",!0)},null,8,["modelValue","rules"])]),t("div",Y,[n(c,{modelValue:e.end,"onUpdate:modelValue":o[4]||(o[4]=s=>e.end=s),type:"date",label:"Dead Line *",placeholder:"Dead Line Here",rules:e.rs("dead line",!0)},null,8,["modelValue","rules"])]),t("div",Z,[n(p,{modelValue:e.attachments,"onUpdate:modelValue":o[5]||(o[5]=s=>e.attachments=s),dropzone:""},null,8,["modelValue"])]),t("div",$,[n(l,{theme:"snow",toolbar:"minimal",contentType:"html",content:e.description,"onUpdate:content":o[6]||(o[6]=s=>e.description=s),placeholder:"Description Html Contant"},null,8,["content"])])])])]),_:1},512)]),_:1},8,["show","busy","onAdd"])}const te=j(Q,[["render",ee]]);const oe=U({model:{prop:"show",event:"change"},props:{show:{type:Boolean,default:!0},task:{type:Object,required:!0}},setup(a,{emit:o}){return{props:a,close:()=>{o("update:show",!1)}}}}),se=a=>(B("data-v-95937cf5"),a=a(),D(),a),ae={class:"layout va-gutter-1"},le={class:"row"},ne=se(()=>t("div",{class:"flex xs12"},[t("div",{class:"item mb-4"},[t("div",{class:"form-title"},[t("span",{class:"text"},"Show Task")])])],-1)),re={class:"flex xs12"},de=["innerHTML"],ie={class:"flex xs12"},ce={class:"item actions-btns"};function ue(a,o,b,e,_,v){const c=r("va-icon"),u=r("va-button"),p=r("va-modal");return k(),C(p,{modelValue:a.props.show,"onUpdate:modelValue":o[0]||(o[0]=l=>a.props.show=l),fullscreen:!1,"hide-default-actions":"","no-outside-dismiss":"",class:"form-sceen"},{default:f(()=>[t("div",ae,[t("div",le,[ne,t("div",re,[t("div",{class:"item",innerHTML:a.task.description},null,8,de)]),t("div",ie,[t("div",ce,[n(u,{color:"danger",size:"small",onClick:a.close},{default:f(()=>[n(c,{class:"material-icons"},{default:f(()=>[w("close")]),_:1}),w(" Close")]),_:1},8,["onClick"])])])])])]),_:1},8,["modelValue"])}const pe=j(oe,[["render",ue],["__scopeId","data-v-95937cf5"]]),me={components:{StatusBtn:S,RemoveEditButton:R,Taskmodel:pe},props:{project_id:{type:Number,required:!0},tasks:{type:Array,required:!0}},setup(a){return{props:a}}},_e={class:"va-table-responsive"},he={class:"va-table"},ve=t("thead",null,[t("tr",null,[t("th",null,"Title"),t("th",null,"Employees"),t("th",null,"AssignAt"),t("th",null,"DeadLine"),t("th",null,"Status"),t("th",null,"action")])],-1);function fe(a,o,b,e,_,v){const c=r("status-btn"),u=r("taskmodel"),p=r("remove-edit-button");return k(),g("div",_e,[t("table",he,[ve,t("tbody",null,[(k(!0),g(L,null,P(e.props.tasks,(l,h)=>(k(),g("tr",{key:h},[t("td",null,y(l.title),1),t("td",null,y(l.employees.map(m=>m.name).join(",")),1),t("td",null,y(l.start),1),t("td",null,y(l.end),1),t("td",null,[n(c,{status:l.status,size:"small"},null,8,["status"])]),t("td",null,[n(p,{isView:!0,isEdit:!1,onViewClick:m=>l.showModel=!0,onRemoveClick:o[0]||(o[0]=m=>a.remove(a.rowData,a.rowIndex))},{default:f(()=>[n(u,{show:l.showModel,"onUpdate:show":m=>l.showModel=m,task:l},null,8,["show","onUpdate:show","task"])]),_:2},1032,["onViewClick"])])]))),128))])])])}const be=j(me,[["render",fe]]),ye={props:{id:{type:[String,Number],required:!0}},components:{AppLayout:A,PageTitleBox:E,ShowProject:M,StatusBtn:S,CreateButton:N,AddTask:te,TaskList:be},setup(a){const o=q(),b=i(o.auth_id),e=i(null),_=i(!0),v=i(!1),c=i([]),u=i([]),p=i([]);(async()=>{_.value=!0;try{const s=route("project.show",{project:a.id}),{data:d}=await axios.get(s);e.value=d}catch(s){console.error(s)}_.value=!1})(),axios.get(route("project.members",{project:a.id})).then(({data:s})=>c.value=s),axios.get(route("category.index",{all:!0})).then(({data:s})=>u.value=s);const h=s=>{p.value.push(s),v.value=!1};return(async()=>{try{const s=route("project.task.index",{project:a.id}),{data:d}=await axios.get(s);p.value=d.map(x=>(x.showModel=!1,x))}catch(s){console.error(s)}})(),{showCreateTask:v,busy:_,id:a.id,project:e,auth_id:b,members:c,categories:u,push:h,tasks:p}}},we={key:0};function ke(a,o,b,e,_,v){const c=r("page-title-box"),u=r("task-list"),p=r("status-btn"),l=r("create-button"),h=r("add-task"),m=r("show-project"),s=r("app-layout");return k(),C(s,{busy:e.busy},{default:f(()=>[t("div",null,[n(c,{title:"Project"})]),e.project?(k(),g("div",we,[n(m,{auth_id:e.auth_id,id:e.id,project:e.project},{tasks:f(()=>[n(u,{tasks:e.tasks,project_id:e.project.id},null,8,["tasks","project_id"])]),default:f(()=>[t("div",null,[t("h1",null,[w(" Assigner: "),t("b",null,y(e.project.assigner.name),1)]),t("h1",null,[w(" Team: "),t("b",null,y(e.project.team.title),1)]),t("div",null,[w("Status: "),n(p,{status:e.project.status},null,8,["status"])]),t("div",null,[w(" Project Assin: "),t("b",null,y(e.project.start),1)]),t("div",null,[w(" DeadLine: "),t("b",null,y(e.project.end),1)]),t("div",null,[n(l,{title:"Add Task",onClick:o[0]||(o[0]=d=>e.showCreateTask=!0)})]),n(h,{show:e.showCreateTask,"onUpdate:show":o[1]||(o[1]=d=>e.showCreateTask=d),members:e.members,categories:e.categories,project_id:e.project.id,onPush:e.push},null,8,["show","members","categories","project_id","onPush"])])]),_:1},8,["auth_id","id","project"])])):H("",!0)]),_:1},8,["busy"])}const Be=j(ye,[["render",ke]]);export{Be as default};
