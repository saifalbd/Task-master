import{_ as V,d as y,o as P,m as R,r as b,a as h,c as E,b as o,w as l,l as N,e as n,f as k,g as $,h as q,i,j as B,u as C,k as I}from"./app-0d2f6224.js";const z=y({components:{Open:P},setup(){const e=R(),s=C(),u=b(!1),v=b(),d=h({userName:"",password:""}),m=h({userName:"",password:""}),c=h({userName:[{required:!0,message:"Email Must be Required",trigger:"change"}],password:[{required:!0,message:"Password Must be Required",trigger:"change"}]});return{ruleForm:m,rules:c,errors:d,ruleFormRef:v,busy:u,login:async f=>{await f.validate(async(g,w)=>{if(g)try{const r="/login";u.value=!0;const{data:a}=await axios.post(r,{email:m.userName,password:m.password});e.addToken(a.token),e.addUser(a.user),s.push({name:"home"})}catch(r){console.error(r);const a=r==null?void 0:r.response;if(a&&a.status==422){const t=a.data.errors;N.hasIn(t,"loginEmail")&&(d.userName=t.loginEmail[0]),N.hasIn(t,"loginPassword")&&(d.password=t.loginPassword[0])}}else console.log("error submit!",w);u.value=!1})}}}}),D={class:"login-page"},U=i("div",{class:"card-header"},[i("span",null,"Login")],-1),L={class:"login-btn-box"},M=i("span",{class:"ml-2"},"Login",-1),T={class:"redirect-info"},j=i("b",null,"Register",-1);function O(e,s,u,v,d,m){const c=n("el-input"),_=n("el-form-item"),f=n("open"),g=n("el-icon"),w=n("el-button"),r=n("el-link"),a=n("el-form"),t=n("el-card"),F=I("loading");return k(),E("div",D,[o(t,null,{header:l(()=>[U]),default:l(()=>[$((k(),q(a,{ref:"ruleFormRef",model:e.ruleForm,rules:e.rules,"label-position":"top"},{default:l(()=>[o(_,{label:"Email",prop:"userName",error:e.errors.userName},{default:l(()=>[o(c,{size:"large",placeholder:"Please Input",modelValue:e.ruleForm.userName,"onUpdate:modelValue":s[0]||(s[0]=p=>e.ruleForm.userName=p)},null,8,["modelValue"])]),_:1},8,["error"]),o(_,{label:"Password",prop:"password",error:e.errors.password},{default:l(()=>[o(c,{"show-password":"",size:"large",placeholder:"Please Input",modelValue:e.ruleForm.password,"onUpdate:modelValue":s[1]||(s[1]=p=>e.ruleForm.password=p)},null,8,["modelValue"])]),_:1},8,["error"]),i("div",L,[o(w,{size:"large",type:"primary",onClick:s[2]||(s[2]=p=>e.login(e.ruleFormRef))},{default:l(()=>[o(g,null,{default:l(()=>[o(f)]),_:1}),M]),_:1})]),i("div",T,[B(" Don't have an account yet? "),o(r,{href:"/register"},{default:l(()=>[j]),_:1})])]),_:1},8,["model","rules"])),[[F,e.busy]])]),_:1})])}const A=V(z,[["render",O]]);export{A as default};
