import{a as R,S as U}from"./app-layout-62a20c1a.js";import{_ as W}from"./PageTitleBox-34f8655b.js";import{_ as G,p as J,n as K,r as d,q as O,s as Q,t as q,v as X,h as z,w as a,e as r,f as c,i as s,b as l,j as k,c as p,x,F as T,y as Y,u as Z,z as m,A as $,B as ee,C as oe,D as te}from"./app-fc468544.js";import{r as P}from"./api-661a824c.js";import{h as se}from"./moment-fbc5633a.js";import{C as ae}from"./CreateButton-8d1e5d7b.js";import{C as ne}from"./Create-87c097d9.js";import"./FormDialog-3370bb78.js";import"./index-dc654618.js";const le={components:{Plus:J,CreateButton:ae,ArrowDown:K,AppLayout:R,PageTitleBox:W,statusBtnVue:U,AddTask:ne},setup(){const y=d(!1),u=d(!1),V=d([]),t=d([]),j=Z(),A=d([]),S=d([]),g=d([]),w=d([]),v=d([]),h=e=>se(e).fromNow(),B=e=>{j.push(e)},C=(e=null)=>{P(0,o=>{A.value=o},e),P(1,o=>{S.value=o},e),P(2,o=>{g.value=o},e),P(3,o=>{w.value=o},e),P(4,o=>{v.value=o},e)};C();const D=O(()=>[{title:"Pending Tasks",items:A.value},{title:"Accepted Tasks",items:S.value},{title:"Working Tasks",items:g.value},{title:"Submited Tasks",isSubmit:!0,items:w.value},{title:"Completed Tasks",items:v.value}]),N=d([]);axios.get(route("taskType.index")).then(({data:e})=>{N.value=e});const f=d([]);axios.get(route("employeeProposal")).then(({data:e})=>{f.value=e});const E=async(e,o)=>{try{await axios.get(route("acceptProposal",{employee:e})),f.value.splice(o,1)}catch(_){console.error(_)}},L=async(e,o)=>{try{await axios.get(route("denyProposal",{employee:e})),f.value.splice(o,1)}catch(_){console.error(_)}},I=async(e,o,_,i)=>{try{const b=route("task.changeStatus",{task:o}),{data:M}=await axios.post(b,{status:e,notify:0});_.splice(i,1)}catch(b){console.error(b)}},F=e=>{A.value.push(e),u.value=!1};return Q(()=>{q("employees",e=>{V.value=e}),q("categories",e=>{t.value=e})}),{atNow:h,go:B,push:F,changeStatus:I,doArchive:(e,o)=>{v.value.splice(o,1),axios.post(route("task.doArchive",{task:e.id}),{prop:"user_archive",do:e.user_archive?0:1})},loadTask:C,statusList:X,busy:y,employeeProposals:f,Accepted:E,Deny:L,showCreate:u,tasks:D,taskTypes:N,employees:V,categories:t}}},H=y=>(oe("data-v-54b41f45"),y=y(),te(),y),re={class:"task-box-list"},ce=["md"],de={class:"box-card"},ie={class:"card-header"},ue={class:"recent-task-list"},_e={class:"avatar-box"},pe=["src"],me={class:"task-line"},ve={class:"center"},ke={class:"el-dropdown-link"},ye=["onClick"],he={class:"right-side-bar"},fe=H(()=>s("div",{class:"card-header"},[s("span",null,"Employee Proposal")],-1)),ge={class:"employee-proposals"},we=["onClick"],Ce={class:"line-one"},be={style:{"text-align":"center"}},xe=H(()=>s("div",null,"Send you Employee Proposal as empoyeee",-1)),Te={class:"line-two"};function Pe(y,u,V,t,j,A){const S=r("create-button"),g=r("arrow-down"),w=r("el-icon"),v=r("el-button"),h=r("el-dropdown-item"),B=r("el-dropdown-menu"),C=r("el-dropdown"),D=r("page-title-box"),N=r("el-avatar"),f=r("va-avatar"),E=r("el-link"),L=r("el-card"),I=r("add-task"),F=r("app-layout");return c(),z(F,{busy:t.busy},{default:a(()=>[s("div",null,[l(D,{title:"Home Board"},{default:a(()=>[l(S,{title:"Add Task",onClick:u[0]||(u[0]=n=>t.showCreate=!0)}),l(C,null,{dropdown:a(()=>[l(B,null,{default:a(()=>[l(h,{onClick:u[1]||(u[1]=n=>t.loadTask(null))},{default:a(()=>[k("All Employees")]),_:1}),(c(!0),p(T,null,x(t.employees,n=>(c(),z(h,{key:n.id,onClick:e=>t.loadTask(n.id)},{default:a(()=>[k(m(n.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:a(()=>[l(v,{type:"primary",style:{"margin-left":"15px"}},{default:a(()=>[k(" Employees"),l(w,{class:"el-icon--right"},{default:a(()=>[l(g)]),_:1})]),_:1})]),_:1})]),_:1})]),s("div",{class:Y(["home-page admin",{hasProposal:!!t.employeeProposals.length}])},[s("div",re,[(c(!0),p(T,null,x(t.tasks,(n,e)=>(c(),p("div",{sm:24,md:4.8,key:e},[s("div",de,[s("div",ie,[s("span",null,[s("b",null,m(n.title),1)])]),s("ul",ue,[(c(!0),p(T,null,x(n.items,(o,_)=>(c(),p("li",{key:_,style:$({border:`1px solid ${o.category.color.border}`,color:o.category.color.text,backgroundColor:o.category.color.bg})},[s("div",_e,[l(N,{size:25},{default:a(()=>[s("img",{src:o.employee.model.avatar.url},null,8,pe)]),_:2},1024)]),s("div",me,[s("b",null,m(o.employee.model.name),1),s("small",ve,m(t.atNow(o.created_at)),1),l(C,null,{dropdown:a(()=>[l(B,null,{default:a(()=>[(c(!0),p(T,null,x(t.statusList.filter(i=>![0,1,2,3,6,7].includes(i.status)).filter(i=>i.status!=o.status),(i,b)=>(c(),z(h,{key:b,onClick:M=>t.changeStatus(i.status,o.id,n.items,_)},{default:a(()=>[k(m(i.title),1)]),_:2},1032,["onClick"]))),128)),o.status==4?(c(),z(h,{key:0,onClick:i=>t.doArchive(o,_)},{default:a(()=>[k(" Archive ")]),_:2},1032,["onClick"])):ee("",!0)]),_:2},1024)]),default:a(()=>[s("span",ke,[l(w,{class:"el-icon--right"},{default:a(()=>[l(g)]),_:1})])]),_:2},1024)]),s("div",{class:"text-box",onClick:i=>t.go({name:"task.show",params:{id:o.id}})},m(o.title),9,ye)],4))),128))])])],8,ce))),128))]),s("div",he,[l(L,{class:"box-card"},{header:a(()=>[fe]),default:a(()=>[s("ul",ge,[(c(!0),p(T,null,x(t.employeeProposals,(n,e)=>(c(),p("li",{key:e},[s("div",{class:"avatar-box",onClick:o=>t.go({name:"userProfile",params:{user:n.user.id}})},[l(f,{src:n.user.avatar.url,size:30},null,8,["src"])],8,we),s("div",Ce,[s("div",null,[l(E,{underline:!1,onClick:o=>t.go({name:"userProfile",params:{user:n.user.id}})},{default:a(()=>[s("b",null,m(n.user.name),1)]),_:2},1032,["onClick"]),s("small",be,m(t.atNow(n.created_at)),1)]),xe]),s("div",Te,[l(v,{size:"small",type:"primary",onClick:o=>t.Accepted(n,e)},{default:a(()=>[k(" Accepted ")]),_:2},1032,["onClick"]),l(v,{size:"small",type:"danger",onClick:o=>t.Deny(n,e)},{default:a(()=>[k(" Deny ")]),_:2},1032,["onClick"])])]))),128))])]),_:1})])],2),l(I,{show:t.showCreate,"onUpdate:show":u[2]||(u[2]=n=>t.showCreate=n),employees:t.employees,categories:t.categories,taskTypes:t.taskTypes,onPush:t.push},null,8,["show","employees","categories","taskTypes","onPush"])]),_:1},8,["busy"])}const Ie=G(le,[["render",Pe],["__scopeId","data-v-54b41f45"]]);export{Ie as default};
